{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":343278744,"authorName":"Subbu Allamaraju","from":"Subbu Allamaraju &lt;subbu@...&gt;","profile":"sallamar","replyTo":"SENDER","senderId":"hBneOZpuQazWNnMHd9B_GnFuAaSkGQ6q_NeBBRg4-10E_fZO0TvKHVNwMRoPIRCN7SjsbHlTUfLIv92PFhgYlbi3J_TEVZ45eQ","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [rest-discuss] Re: Trailer header and tomcat","postDate":"1249522338","msgId":13166,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDAwQUEzRDkyLTY3MDgtNEUzRi1BQjYwLTEyQTY1NzZFOUQ4M0BzdWJidS5vcmc+","inReplyToHeader":"PGg1Y3ZnMytzbHI2QGVHcm91cHMuY29tPg==","referencesHeader":"PGg1Y3ZnMytzbHI2QGVHcm91cHMuY29tPg=="},"prevInTopic":13165,"nextInTopic":13167,"prevInTime":13165,"nextInTime":13167,"topicId":13162,"numMessagesInTopic":11,"msgSnippet":"This may very well be a bug/limitation in Tomcat. By the way, have you considered using some other application hash for the Etag. Computing ETag based on the","rawEmail":"Return-Path: &lt;subbu@...&gt;\r\nX-Sender: subbu@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 46275 invoked from network); 6 Aug 2009 01:40:26 -0000\r\nX-Received: from unknown (69.147.108.201)\n  by m3.grp.re1.yahoo.com with QMQP; 6 Aug 2009 01:40:26 -0000\r\nX-Received: from unknown (HELO mail-pz0-f175.google.com) (209.85.222.175)\n  by mta2.grp.re1.yahoo.com with SMTP; 6 Aug 2009 01:40:25 -0000\r\nX-Received: by pzk5 with SMTP id 5so413236pzk.23\n        for &lt;rest-discuss@yahoogroups.com&gt;; Wed, 05 Aug 2009 18:40:25 -0700 (PDT)\r\nX-Received: by 10.114.169.5 with SMTP id r5mr8593212wae.136.1249522341793;\n        Wed, 05 Aug 2009 18:32:21 -0700 (PDT)\r\nReturn-Path: &lt;subbu@...&gt;\r\nX-Received: from ?192.168.1.103? (c-98-237-203-77.hsd1.wa.comcast.net [98.237.203.77])\n        by mx.google.com with ESMTPS id n30sm2550604wag.41.2009.08.05.18.32.20\n        (version=TLSv1/SSLv3 cipher=RC4-MD5);\n        Wed, 05 Aug 2009 18:32:20 -0700 (PDT)\r\nCc: rest-discuss@yahoogroups.com\r\nMessage-Id: &lt;00AA3D92-6708-4E3F-AB60-12A6576E9D83@...&gt;\r\nTo: Keyur Shah &lt;keyurva@...&gt;\r\nIn-Reply-To: &lt;h5cvg3+slr6@...&gt;\r\nContent-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes\r\nContent-Transfer-Encoding: quoted-printable\r\nMime-Version: 1.0 (Apple Message framework v935.3)\r\nDate: Wed, 5 Aug 2009 18:32:18 -0700\r\nReferences: &lt;h5cvg3+slr6@...&gt;\r\nX-Mailer: Apple Mail (2.935.3)\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Subbu Allamaraju &lt;subbu@...&gt;\r\nSubject: Re: [rest-discuss] Re: Trailer header and tomcat\r\nX-Yahoo-Group-Post: member; u=343278744; y=AqMY0ufH73wwJ79rVUpFdket1Fxs3oKeMqFBKrjFJRtpoQU\r\nX-Yahoo-Profile: sallamar\r\n\r\nThis may very well be a bug/limitation in Tomcat. By the way, have you  \nco=\r\nnsidered using some other application hash for the Etag. Computing  \nETag b=\r\nased on the byte stream is not always the most efficient.\n\nSubbu\n\nOn Aug 5,=\r\n 2009, at 3:01 PM, Keyur Shah wrote:\n\n&gt; Yes, it&#39;s a tomcat question and a h=\r\nttp question. I was asking more  \n&gt; from the http perspective here - whethe=\r\nr what I&#39;m doing is http  \n&gt; coherent or not.\n&gt;\n&gt; About writing the content=\r\n to the buffer: Buffering is what I do  \n&gt; right now and that is what I&#39;m t=\r\nrying to avoid. With a large number  \n&gt; of concurrent users, the buffering =\r\nis proving to be a performance  \n&gt; bottleneck and is causing frequent GC sw=\r\neeps.\n&gt;\n&gt; --Keyur\n&gt;\n&gt; --- In rest-discuss@yahoogroups.com, Solomon Duskis &lt;=\r\nsduskis@...&gt;  \n&gt; wrote:\n&gt; &gt;\n&gt; &gt; I&#39;m not sure that you&#39;re on the right discu=\r\nssion list for this  \n&gt; issue. With\n&gt; &gt; that said, you have to set headers =\r\nbefore you open the outgoing  \n&gt; stream. One\n&gt; &gt; way to do that is to write=\r\n to a buffer (such as a  \n&gt; ByteArrayOutputStream),\n&gt; &gt; get the size, write=\r\n the headers and then flushing the buffer to the\n&gt; &gt; servletResponse&#39;s Outp=\r\nutStream.\n&gt; &gt; -Solomon\n&gt; &gt;\n&gt; &gt; On Wed, Aug 5, 2009 at 1:43 PM, Keyur Shah &lt;=\r\nkeyurva@...&gt; wrote:\n&gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; Tomcat by default sends chunked r=\r\nesponses =3D&gt; Transfer- \n&gt; Encoding:chunked\n&gt; &gt; &gt;\n&gt; &gt; &gt; I&#39;m calculating the=\r\n ETag for the response dynamically as the  \n&gt; content is\n&gt; &gt; &gt; being writte=\r\nn to the response stream. Since I&#39;ll know the final  \n&gt; value of the\n&gt; &gt; &gt; =\r\nETag only when the stream is closed, I indicate that using the  \n&gt; Trailer\n=\r\n&gt; &gt; &gt; header =3D&gt; Trailer: ETag\n&gt; &gt; &gt;\n&gt; &gt; &gt; I&#39;m ensuring that just before t=\r\nhe stream is closed, I set the  \n&gt; ETag header\n&gt; &gt; &gt; =3D&gt; ETag: SomeETagVal=\r\nue\n&gt; &gt; &gt;\n&gt; &gt; &gt; However, when I look at the response on the client, the ETag=\r\n  \n&gt; header was\n&gt; &gt; &gt; never written.\n&gt; &gt; &gt;\n&gt; &gt; &gt; Is this a tomcat specific =\r\nbug or am I doing something wrong?\n&gt; &gt; &gt;\n&gt; &gt; &gt; Thanks,\n&gt; &gt; &gt; Keyur\n&gt; &gt; &gt;\n&gt; =\r\n&gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt;\n&gt;\n&gt;\n&gt; \n\n\n"}}