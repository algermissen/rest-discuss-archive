{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":266460716,"authorName":"Eric J. Bowman","from":"&quot;Eric J. Bowman&quot; &lt;eric@...&gt;","replyTo":"SENDER","senderId":"l9xgRDcY-etAcnzdNy_NjH6vSbLOcIMrwNmubDNZ0XAMqC7szZH_ha_c4DT5aBlaa8fvvSkxSbUbqmLA_2PasT7uvx4zHki3EyO8ctrXGQ","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: Fun with DELETE","postDate":"1183376986","msgId":9307,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PFc3NDgyMDMxMzc3ODE5MTE4MzM3Njk4NkBtYWlsLm1haWxzbmFyZS5uZXQ+"},"prevInTopic":8638,"nextInTopic":9308,"prevInTime":9306,"nextInTime":9308,"topicId":8604,"numMessagesInTopic":107,"msgSnippet":"My funky two-stage DELETE idea has a lost update problem due to its non-idempotence, the fix is a conditional DELETE. The server is set up to respond 410","rawEmail":"Return-Path: &lt;eric@...&gt;\r\nX-Sender: eric@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nReceived: (qmail 13972 invoked from network); 2 Jul 2007 11:49:52 -0000\r\nReceived: from unknown (66.218.66.70)\n  by m57.grp.scd.yahoo.com with QMQP; 2 Jul 2007 11:49:52 -0000\r\nReceived: from unknown (HELO mail.mailsnare.net) (209.236.228.78)\n  by mta12.grp.scd.yahoo.com with SMTP; 2 Jul 2007 11:49:52 -0000\r\nX-Virus-Scanned: by ClamAV at mailsnare.net\r\nX-Message-ID: 749f92e98ac7daa1b40c7093adeba4681e7bd0d5869d272e49d9ebde58f8da29\r\nReceived: from mail.mailsnare.net (unknown [209.236.228.74])\n\tby mail.mailsnare.net (Postfix) with ESMTP id 799EE78A3B\n\tfor &lt;rest-discuss@yahoogroups.com&gt;; Mon,  2 Jul 2007 11:49:47 +0000 (UTC)\r\nTo: rest-discuss@yahoogroups.com\r\nImportance: Normal\r\nMessage-ID: &lt;W74820313778191183376986@...&gt;\r\nX-Mailer: Mintersoft EdgeDesk, Build 4.03.0105\r\nDate: Mon, 02 Jul 2007 11:49:46 +0000\r\nOrganization: Bison Systems Corporation\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;utf-8&quot;\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: &quot;Eric J. Bowman&quot; &lt;eric@...&gt;\r\nReply-To: eric@...\r\nSubject: Re: Fun with DELETE\r\nX-Yahoo-Group-Post: member; u=266460716\r\n\r\nMy funky two-stage DELETE idea has a &quot;lost update problem&quot; due to its \nnon-idempotence, the fix is a conditional DELETE.\n\nThe server is set up to respond 410 Gone when a GET request maps to a \nzero-byte file on the server.  Deleting the file from the filesystem \nresults in a 404 Not Found, by default.  So the first stage DELETE \nchanges the source-file size to zero bytes, which sets a 410 Gone.\n\nWhat I want to do is have a second DELETE on the same URL erase the \nfile, thus changing the response code to 404.  But if two users DELETE \nthe same resource, the inadvertent result (which neither user intends) \nis the 404 response on a subsequent GET.  My DELETE implementation is \nnon-idempotent because the side-effects of a second DELETE request \nidentical to the first DELETE request are different.  Even though each \nDELETE is idempotent by itself, the sequence is not.\n\nThe conditional DELETE is an if-match request.  A 412 Precondition \nFailed response is used, if no match.  A 409 Conflict response is used \nif the filesize is zero bytes, with a message body &quot;Conditional DELETE \nrequest detected.&quot;  If the filesize is greater than zero bytes and the \nDELETE is unconditional, the response is 409 Conflict with a message \nbody &quot;Unconditional DELETE request detected.&quot;  The existing 200 OK \nresponse and message body are returned if the conditional DELETE \nsucceeds.  Conditional DELETE requests using anything but if-match \nresult in a 400 Bad Request response.\n\nThe second DELETE is unconditional, which is not identical to the \nconditional DELETE request in terms of idempotence because the headers \nare different.  The response is 204 No Content after the source file \nis deleted from disk, subsequent DELETE requests respond 404.  Now, \nthe methods and sequences are idempotent, and the lost-update problem \nis fixed.\n\n-Eric\n\n\n\n\n"}}