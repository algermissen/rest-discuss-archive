{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":409447813,"authorName":"Keyur Shah","from":"&quot;Keyur Shah&quot; &lt;keyurva@...&gt;","profile":"keyurva","replyTo":"SENDER","senderId":"ygBeHiHQ9F8ZY8KMX5h4HcIA9wrBLwAWVHemwYs-zf3ukC36HV-uTCxaqhCot8WxeUtz62VH1f0byLvXDoWfYf4kgFCEG8o","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: Trailer header and tomcat","postDate":"1249509699","msgId":13164,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGg1Y3ZnMytzbHI2QGVHcm91cHMuY29tPg==","inReplyToHeader":"PDU1YzYwZTM3MDkwODA1MTIyMHE3NmUxZTIxM2kzYWI5YzMyODdkMzZkMDdmQG1haWwuZ21haWwuY29tPg=="},"prevInTopic":13163,"nextInTopic":13165,"prevInTime":13163,"nextInTime":13165,"topicId":13162,"numMessagesInTopic":11,"msgSnippet":"Yes, it s a tomcat question and a http question. I was asking more from the http perspective here - whether what I m doing is http coherent or not. About","rawEmail":"Return-Path: &lt;keyurva@...&gt;\r\nX-Sender: keyurva@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 260 invoked from network); 5 Aug 2009 22:02:08 -0000\r\nX-Received: from unknown (69.147.108.200)\n  by m4.grp.re1.yahoo.com with QMQP; 5 Aug 2009 22:02:08 -0000\r\nX-Received: from unknown (HELO n40b.bullet.mail.sp1.yahoo.com) (66.163.168.154)\n  by mta1.grp.re1.yahoo.com with SMTP; 5 Aug 2009 22:02:08 -0000\r\nX-Received: from [69.147.65.174] by n40.bullet.mail.sp1.yahoo.com with NNFMP; 05 Aug 2009 22:01:40 -0000\r\nX-Received: from [98.137.34.73] by t12.bullet.mail.sp1.yahoo.com with NNFMP; 05 Aug 2009 22:01:40 -0000\r\nDate: Wed, 05 Aug 2009 22:01:39 -0000\r\nTo: rest-discuss@yahoogroups.com\r\nMessage-ID: &lt;h5cvg3+slr6@...&gt;\r\nIn-Reply-To: &lt;55c60e370908051220q76e1e213i3ab9c3287d36d07f@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;Keyur Shah&quot; &lt;keyurva@...&gt;\r\nSubject: Re: Trailer header and tomcat\r\nX-Yahoo-Group-Post: member; u=409447813; y=R1F5T_vXhGHDk_QO594E5ZANL8FKx3hiWvRy5ddxb4WktA\r\nX-Yahoo-Profile: keyurva\r\n\r\nYes, it&#39;s a tomcat question and a http question. I was asking more from the=\r\n http perspective here - whether what I&#39;m doing is http coherent or not.\n\nA=\r\nbout writing the content to the buffer: Buffering is what I do right now an=\r\nd that is what I&#39;m trying to avoid. With a large number of concurrent users=\r\n, the buffering is proving to be a performance bottleneck and is causing fr=\r\nequent GC sweeps.\n\n--Keyur\n\n--- In rest-discuss@yahoogroups.com, Solomon Du=\r\nskis &lt;sduskis@...&gt; wrote:\n&gt;\n&gt; I&#39;m not sure that you&#39;re on the right discuss=\r\nion list for this issue.  With\n&gt; that said, you have to set headers before =\r\nyou open the outgoing stream.  One\n&gt; way to do that is to write to a buffer=\r\n (such as a ByteArrayOutputStream),\n&gt; get the size, write the headers and t=\r\nhen flushing the buffer to the\n&gt; servletResponse&#39;s OutputStream.\n&gt; -Solomon=\r\n\n&gt; \n&gt; On Wed, Aug 5, 2009 at 1:43 PM, Keyur Shah &lt;keyurva@...&gt; wrote:\n&gt; \n&gt; =\r\n&gt;\n&gt; &gt;\n&gt; &gt; Tomcat by default sends chunked responses =3D&gt; Transfer-Encoding:=\r\nchunked\n&gt; &gt;\n&gt; &gt; I&#39;m calculating the ETag for the response dynamically as th=\r\ne content is\n&gt; &gt; being written to the response stream. Since I&#39;ll know the =\r\nfinal value of the\n&gt; &gt; ETag only when the stream is closed, I indicate that=\r\n using the Trailer\n&gt; &gt; header =3D&gt; Trailer: ETag\n&gt; &gt;\n&gt; &gt; I&#39;m ensuring that =\r\njust before the stream is closed, I set the ETag header\n&gt; &gt; =3D&gt; ETag: Some=\r\nETagValue\n&gt; &gt;\n&gt; &gt; However, when I look at the response on the client, the E=\r\nTag header was\n&gt; &gt; never written.\n&gt; &gt;\n&gt; &gt; Is this a tomcat specific bug or =\r\nam I doing something wrong?\n&gt; &gt;\n&gt; &gt; Thanks,\n&gt; &gt; Keyur\n&gt; &gt;\n&gt; &gt;  \n&gt; &gt;\n&gt;\n\n\n\n"}}