{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":209043068,"authorName":"Solomon Duskis","from":"Solomon Duskis &lt;sduskis@...&gt;","profile":"sduskis","replyTo":"SENDER","senderId":"Mwanacqx-09tXGPSd9ajSqaPE9yimNkA_xXEddpa0NVzvdNut4jHgLAw-Z8AhFJxOP9N_CnydX6feiIKaOaZf_yBrCdKcV5UwQ","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [rest-discuss] Re: Trailer header and tomcat","postDate":"1249519288","msgId":13165,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDU1YzYwZTM3MDkwODA1MTc0MWg2Y2RiNzNlOGpjZWMwOGFjZTJlZDNhYjBhQG1haWwuZ21haWwuY29tPg==","inReplyToHeader":"PGg1Y3ZnMytzbHI2QGVHcm91cHMuY29tPg==","referencesHeader":"PDU1YzYwZTM3MDkwODA1MTIyMHE3NmUxZTIxM2kzYWI5YzMyODdkMzZkMDdmQG1haWwuZ21haWwuY29tPgkgPGg1Y3ZnMytzbHI2QGVHcm91cHMuY29tPg=="},"prevInTopic":13164,"nextInTopic":13166,"prevInTime":13164,"nextInTime":13166,"topicId":13162,"numMessagesInTopic":11,"msgSnippet":"You ll get HTTP experts on the rest-discuss group, but isn t the intent of the rest-discuss group to discuss the concepts and implementation of REST? I guess","rawEmail":"Return-Path: &lt;sduskis@...&gt;\r\nX-Sender: sduskis@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 84320 invoked from network); 6 Aug 2009 00:42:29 -0000\r\nX-Received: from unknown (69.147.108.202)\n  by m8.grp.re1.yahoo.com with QMQP; 6 Aug 2009 00:42:29 -0000\r\nX-Received: from unknown (HELO qw-out-2122.google.com) (74.125.92.26)\n  by mta3.grp.re1.yahoo.com with SMTP; 6 Aug 2009 00:42:28 -0000\r\nX-Received: by qw-out-2122.google.com with SMTP id 5so213612qwi.51\n        for &lt;rest-discuss@yahoogroups.com&gt;; Wed, 05 Aug 2009 17:41:28 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.229.96.142 with SMTP id h14mr2656830qcn.99.1249519288783; Wed, \n\t05 Aug 2009 17:41:28 -0700 (PDT)\r\nIn-Reply-To: &lt;h5cvg3+slr6@...&gt;\r\nReferences: &lt;55c60e370908051220q76e1e213i3ab9c3287d36d07f@...&gt;\n\t &lt;h5cvg3+slr6@...&gt;\r\nDate: Wed, 5 Aug 2009 20:41:28 -0400\r\nMessage-ID: &lt;55c60e370908051741h6cdb73e8jcec08ace2ed3ab0a@...&gt;\r\nTo: Keyur Shah &lt;keyurva@...&gt;\r\nCc: rest-discuss@yahoogroups.com\r\nContent-Type: multipart/alternative; boundary=0016364ee24459195a04706e61e3\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Solomon Duskis &lt;sduskis@...&gt;\r\nSubject: Re: [rest-discuss] Re: Trailer header and tomcat\r\nX-Yahoo-Group-Post: member; u=209043068; y=uC-pTJFjCm4Y1sjGnGpCXFWJlAeFWCVRTN4tdlCYogbtZg\r\nX-Yahoo-Profile: sduskis\r\n\r\n\r\n--0016364ee24459195a04706e61e3\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 7bit\r\n\r\nYou&#39;ll get HTTP experts on the rest-discuss group, but isn&#39;t the intent of\nthe rest-discuss group to discuss the concepts and implementation of REST? I\nguess I&#39;m lamenting that rest-discuss talks about HTTP handling rather than\nsome of the more subtle REST topics.\nWith that said, REST (and HTTP) allows you to layer &quot;middle men&quot; that\nperform specific tasks, such as caching.  Squid is a great way to boost\nperformance through efficient caching.  Something like Squid may be able to\nnot only get rid of those pesky GC sweeps, it will also do core caching that\nwill reduce the load on Tomcat.  I&#39;m not sure about the details of\nimplementing ETags with Squid, but I do think that Squid could be prove\nuseful in solving your problem.\n\n-Solomon\n\nOn Wed, Aug 5, 2009 at 6:01 PM, Keyur Shah &lt;keyurva@...&gt; wrote:\n\n&gt;\n&gt;\n&gt; Yes, it&#39;s a tomcat question and a http question. I was asking more from the\n&gt; http perspective here - whether what I&#39;m doing is http coherent or not.\n&gt;\n&gt; About writing the content to the buffer: Buffering is what I do right now\n&gt; and that is what I&#39;m trying to avoid. With a large number of concurrent\n&gt; users, the buffering is proving to be a performance bottleneck and is\n&gt; causing frequent GC sweeps.\n&gt;\n&gt;\n&gt; --Keyur\n&gt;\n&gt; --- In rest-discuss@yahoogroups.com &lt;rest-discuss%40yahoogroups.com&gt;,\n&gt; Solomon Duskis &lt;sduskis@...&gt; wrote:\n&gt; &gt;\n&gt; &gt; I&#39;m not sure that you&#39;re on the right discussion list for this issue.\n&gt; With\n&gt; &gt; that said, you have to set headers before you open the outgoing stream.\n&gt; One\n&gt; &gt; way to do that is to write to a buffer (such as a ByteArrayOutputStream),\n&gt; &gt; get the size, write the headers and then flushing the buffer to the\n&gt; &gt; servletResponse&#39;s OutputStream.\n&gt; &gt; -Solomon\n&gt; &gt;\n&gt; &gt; On Wed, Aug 5, 2009 at 1:43 PM, Keyur Shah &lt;keyurva@...&gt; wrote:\n&gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; Tomcat by default sends chunked responses =&gt; Transfer-Encoding:chunked\n&gt; &gt; &gt;\n&gt; &gt; &gt; I&#39;m calculating the ETag for the response dynamically as the content is\n&gt; &gt; &gt; being written to the response stream. Since I&#39;ll know the final value\n&gt; of the\n&gt; &gt; &gt; ETag only when the stream is closed, I indicate that using the Trailer\n&gt; &gt; &gt; header =&gt; Trailer: ETag\n&gt; &gt; &gt;\n&gt; &gt; &gt; I&#39;m ensuring that just before the stream is closed, I set the ETag\n&gt; header\n&gt; &gt; &gt; =&gt; ETag: SomeETagValue\n&gt; &gt; &gt;\n&gt; &gt; &gt; However, when I look at the response on the client, the ETag header was\n&gt; &gt; &gt; never written.\n&gt; &gt; &gt;\n&gt; &gt; &gt; Is this a tomcat specific bug or am I doing something wrong?\n&gt; &gt; &gt;\n&gt; &gt; &gt; Thanks,\n&gt; &gt; &gt; Keyur\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt;\n&gt;\n&gt;  \n&gt;\n\r\n--0016364ee24459195a04706e61e3\r\nContent-Type: text/html; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nYou&#39;ll get HTTP experts on the rest-discuss group, but isn&#39;t the in=\r\ntent of the rest-discuss group to discuss the concepts and implementation o=\r\nf REST? I guess I&#39;m lamenting that rest-discuss talks about HTTP handli=\r\nng rather than some of the more subtle REST topics.&lt;div&gt;\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;Wit=\r\nh that said, REST (and HTTP) allows you to layer &quot;middle men&quot; tha=\r\nt perform specific tasks, such as caching. =A0Squid is a great way to boost=\r\n performance through efficient caching. =A0Something like Squid may be able=\r\n to not only get rid of those pesky GC sweeps, it will also do core caching=\r\n that will reduce the load on Tomcat. =A0I&#39;m not sure about the details=\r\n of implementing ETags with Squid, but I do think that Squid could be prove=\r\n useful in solving your problem.&lt;/div&gt;\n&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Solomon&lt;/div&gt;&lt;b=\r\nr&gt;&lt;div class=3D&quot;gmail_quote&quot;&gt;On Wed, Aug 5, 2009 at 6:01 PM, Keyur Shah &lt;sp=\r\nan dir=3D&quot;ltr&quot;&gt;&lt;&lt;a href=3D&quot;mailto:keyurva@...&quot; target=3D&quot;_blank&quot;&gt;k=\r\neyurva@...&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote class=3D&quot;gmail_quote&quot;=\r\n style=3D&quot;margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex&quot;&gt;\n\n=\r\n\n\n\n\n\n\n\n\n\n\n\n&lt;div style=3D&quot;background-color:#ffffff&quot;&gt;\n&lt;span&gt;=A0&lt;/span&gt;\n\n&lt;div =\r\nstyle=3D&quot;width:655px&quot;&gt;\n&lt;div style=3D&quot;width:470px;margin:0;padding:0 25px 0 =\r\n0;float:left&quot;&gt;\n\n    &lt;div&gt;\n                  &lt;p&gt;Yes, it&#39;s a tomcat quest=\r\nion and a http question. I was asking more from the http perspective here -=\r\n whether what I&#39;m doing is http coherent or not.&lt;br&gt;\n&lt;br&gt;\nAbout writing=\r\n the content to the buffer: Buffering is what I do right now and that is wh=\r\nat I&#39;m trying to avoid. With a large number of concurrent users, the bu=\r\nffering is proving to be a performance bottleneck and is causing frequent G=\r\nC sweeps.&lt;/p&gt;\n\n&lt;div&gt;&lt;br&gt;\n&lt;br&gt;\n--Keyur&lt;br&gt;\n&lt;br&gt;\n--- In &lt;a href=3D&quot;mailto:res=\r\nt-discuss%40yahoogroups.com&quot; target=3D&quot;_blank&quot;&gt;rest-discuss@yahoogroups.com=\r\n&lt;/a&gt;, Solomon Duskis &lt;sduskis@...&gt; wrote:&lt;br&gt;\n&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;\n&gt=\r\n; I&#39;m not sure that you&#39;re on the right discussion list for this is=\r\nsue.  With&lt;br&gt;\n&gt; that said, you have to set headers before you open the =\r\noutgoing stream.  One&lt;br&gt;\n&gt; way to do that is to write to a buffer (such=\r\n as a ByteArrayOutputStream),&lt;br&gt;\n&gt; get the size, write the headers and =\r\nthen flushing the buffer to the&lt;br&gt;\n&gt; servletResponse&#39;s OutputStream=\r\n.&lt;br&gt;\n&gt; -Solomon&lt;br&gt;\n&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;\n&gt; On Wed, Aug 5, 2009 at 1:=\r\n43 PM, Keyur Shah &lt;keyurva@...&gt; wrote:&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&g=\r\nt; &gt;&lt;br&gt;\n&gt; &gt; Tomcat by default sends chunked responses =3D&gt; Tra=\r\nnsfer-Encoding:chunked&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt; I&#39;m calculating the =\r\nETag for the response dynamically as the content is&lt;br&gt;\n&gt; &gt; being wri=\r\ntten to the response stream. Since I&#39;ll know the final value of the&lt;br&gt;=\r\n\n&gt; &gt; ETag only when the stream is closed, I indicate that using the T=\r\nrailer&lt;br&gt;\n&gt; &gt; header =3D&gt; Trailer: ETag&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &g=\r\nt; I&#39;m ensuring that just before the stream is closed, I set the ETag h=\r\neader&lt;br&gt;\n&gt; &gt; =3D&gt; ETag: SomeETagValue&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt;=\r\n However, when I look at the response on the client, the ETag header was&lt;br=\r\n&gt;\n&gt; &gt; never written.&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt; Is this a tomcat spe=\r\ncific bug or am I doing something wrong?&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt; Thanks=\r\n,&lt;br&gt;\n&gt; &gt; Keyur&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt;  &lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt;&lt;=\r\nbr&gt;\n&lt;br&gt;\n&lt;/div&gt;&lt;p&gt;&lt;/p&gt;\n \n\n    &lt;/div&gt;  \n\n    \n    &lt;div width=3D&quot;1&quot; style=3D&quot;=\r\ncolor:white;clear:both&quot;&gt;&lt;/div&gt;\n\t\n\t&lt;/div&gt;\n\t\n\t\n\n\n\t\n\n\n\t\n\t\n\t\n\t\n\t\n\n&lt;/blockquote&gt;=\r\n&lt;/div&gt;&lt;br&gt;\n\r\n--0016364ee24459195a04706e61e3--\r\n\n"}}