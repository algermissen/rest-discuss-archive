{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":401876259,"authorName":"Will Hartung","from":"Will Hartung &lt;willh@...&gt;","profile":"gaminginparis","replyTo":"SENDER","senderId":"7HAC7lTitaIYgBm6GycO-k_TXvFW5TbrmPY02GmLemXrX185ay2A0tJ8XiSRnnUafV8AiJ8O6fUoKm6cXmWCID-a3jDVUcM__A","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [rest-discuss] Synchronization of collection resources","postDate":"1279573359","msgId":15865,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PEFBTkxrVGltRmlDYjNnXzBld0JIOFNoNXc4ZktrY0VFY2sxOTdJVGJVMVNPLUBtYWlsLmdtYWlsLmNvbT4=","inReplyToHeader":"PEFBTkxrVGltTGRtb0pHUll5YlVsakFiSFZBSDR6Z2JOOUU2VnR0RWU3UzZuT0BtYWlsLmdtYWlsLmNvbT4=","referencesHeader":"PEFBTkxrVGltTGRtb0pHUll5YlVsakFiSFZBSDR6Z2JOOUU2VnR0RWU3UzZuT0BtYWlsLmdtYWlsLmNvbT4="},"prevInTopic":15864,"nextInTopic":15867,"prevInTime":15864,"nextInTime":15866,"topicId":15859,"numMessagesInTopic":10,"msgSnippet":"... Well, arguably, after your POST, the ETAG will change anyway (I mean, you just modified it, why wouldn t it change?). So you should likely follow your POST","rawEmail":"Return-Path: &lt;willh@...&gt;\r\nX-Sender: willh@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 57799 invoked from network); 19 Jul 2010 21:02:42 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m13.grp.re1.yahoo.com with QMQP; 19 Jul 2010 21:02:42 -0000\r\nX-Received: from unknown (HELO mail-yx0-f175.google.com) (209.85.213.175)\n  by mta2.grp.sp2.yahoo.com with SMTP; 19 Jul 2010 21:02:40 -0000\r\nX-Received: by yxi11 with SMTP id 11so1589832yxi.34\n        for &lt;rest-discuss@yahoogroups.com&gt;; Mon, 19 Jul 2010 14:02:40 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.100.109.13 with SMTP id h13mr5477736anc.193.1279573359801; \n\tMon, 19 Jul 2010 14:02:39 -0700 (PDT)\r\nX-Received: by 10.229.105.13 with HTTP; Mon, 19 Jul 2010 14:02:39 -0700 (PDT)\r\nIn-Reply-To: &lt;AANLkTimLdmoJGRYybUljAbHVAH4zgbN9E6VttEe7S6nO@...&gt;\r\nReferences: &lt;AANLkTimLdmoJGRYybUljAbHVAH4zgbN9E6VttEe7S6nO@...&gt;\r\nDate: Mon, 19 Jul 2010 14:02:39 -0700\r\nMessage-ID: &lt;AANLkTimFiCb3g_0ewBH8Sh5w8fKkcEEck197ITbU1SO-@...&gt;\r\nTo: Glenn Block &lt;glenn.block@...&gt;\r\nCc: rest-discuss@yahoogroups.com\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Will Hartung &lt;willh@...&gt;\r\nSubject: Re: [rest-discuss] Synchronization of collection resources\r\nX-Yahoo-Group-Post: member; u=401876259; y=Zqh2oqBbW4fqsYjaDuSgpmz9w4ljYHnZ1BxpVLI5LnzRj0bEy78p2Q\r\nX-Yahoo-Profile: gaminginparis\r\n\r\nOn Mon, Jul 19, 2010 at 12:53 PM, Glenn Block &lt;glenn.block@...&gt; wrote:\n\n&gt; Probably a noob question, but I will ask anyway. Let&#39;s say I do a\n&gt; GET on a tasks resource which returns a list of tasks. Then I go\n&gt; and do a POST against the same resource in order to add a new tasks.\n&gt; In the meanwhile someone else has gone and posted a task to the\n&gt; same resource. Now I need to determine if the collection I have on\n&gt; the client has changed on the server.\n\n&gt; Is the recommended route to save the ETAG when I did the get against\n&gt; the tasks resource, and after I&#39;ve posted do a GET again against\n&gt; that collection using an if match header?\n\nWell, arguably, after your POST, the ETAG will change anyway (I mean,\nyou just modified it, why wouldn&#39;t it change?). So you should likely\nfollow your POST with a HEAD to get the latest info.\n\nThe problem, of course, is that the &quot;latest info&quot; may not match what you have.\n\nFor example:\n\nA. GET /tasks    // returns task collection\nB. POST /tasks  // updates task collection\nC. HEAD /tasks  // gets ETAG and Last-Modified headers.\n\nThe problem is that when you do the HEAD, the ETAG you get back may\nwell not match the collection of tasks you&#39;re maintaining locally.\nSomeone could have changed /tasks between A and B (changed /tasks\nbefore you did), or even between B and C (after you posted changes,\nbut before you fetched the modification information).\n\nSo, there&#39;s no real way you can ensure that your local copy of tasks\nmatches the servers.\n\nThe better tact, at least initially, is to do a conditional POST,\npassing the IF-MATCH for the ETAG or the Unmodified-Since for a\nLast-Modified date. That&#39;s the &quot;optimistic locking&quot; tactic. If the\nETAG doesn&#39;t match, the POST fails, and it&#39;s up to you to resolve the\nissue, getting a valid ETAG value.\n\nIn the reply to the POST, I think its valid for the response to\ninclude a new ETAG value that matches the state of the resource as a\nresult of the POST. So, if you wish to POST again, you can that new\nETAG value.\n\nAnother thing tied to this is that you might want to be able to use\nthe Last-Modified value to get changes since that time.\n\nGET /tasks   // Gets full collection of tasks, capture Last-Modified\nPOST /tasks  // with Unmodified-Since header set to the Last-Modified\nvalue captured from the GET\n// resource changed behind your back, and you get a 409 result because\nyour Unmodified-Since condition fails, so you try to resync\nGET /tasks?changessince=&lt;Last-Modified value from initial GET&gt;  // get\nchanges, capture Last-Modified again\n// integrate changes and make new POST\nPOST /tasks  // with Unmodified-Since\n// Successful POST, capture Last-Modified again for next time.\n\nRace conditions still exist, but you at least make some effort to work\naround them, and they don&#39;t transparently happen. The optimistic\nlocking part kicks in notifying you of the changes.\n\nRegards,\n\nWill Hartung\n(willh@...)\n\n"}}