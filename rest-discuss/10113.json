{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":302633978,"authorName":"Daniel Yokomizo","from":"&quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;","profile":"daniel_yokomiso","replyTo":"SENDER","senderId":"3Q0kEL88xDhBn8dAwnE-lCbaDiG_E3GIrAr129kflHqxc4BpWQdet0tdj26IIGKJ7PcC0l0UXdFUrz8TekFV83MVM7UVTJSwH44kV9BTiB18YiKu","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Fwd: [rest-discuss] Re: Idempotency of PUT when using IF-MATCH","postDate":"1198897493","msgId":10113,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGU1YzZlY2FiMDcxMjI4MTkwNHY1YWVjNDc5Mm5mOGM4ZTg4NjQxMThjYzVjQG1haWwuZ21haWwuY29tPg==","inReplyToHeader":"PGU1YzZlY2FiMDcxMjI4MTMzOHk3OTk5MGJjOW9mNmY1MWVjYjcyZWRhNDAwQG1haWwuZ21haWwuY29tPg==","referencesHeader":"PGU1YzZlY2FiMDcxMjI3MjMyMHMzZGE1NGZwNmYwM2EwMDMwM2NiMGMxN0BtYWlsLmdtYWlsLmNvbT4JIDwyMDA3MTIyODE2MDg0Ny5HQTE1MjUyQGtsYW5ncmF1bT4JIDxlNWM2ZWNhYjA3MTIyODA4Mzd4ODY0NjNjY2c5MmY3ZTE5MjExMmM0MTU2QG1haWwuZ21haWwuY29tPgkgPEYzNUZFMkU0LTFDMjEtNDgyQy1BNjhBLTFDQzlGQzVBQUQ3NEBnYml2LmNvbT4JIDxlNWM2ZWNhYjA3MTIyODEzMzh5Nzk5OTBiYzlvZjZmNTFlY2I3MmVkYTQwMEBtYWlsLmdtYWlsLmNvbT4="},"prevInTopic":0,"nextInTopic":10116,"prevInTime":10112,"nextInTime":10114,"topicId":10113,"numMessagesInTopic":2,"msgSnippet":"Forwarding to the list because I hit reply instead of reply all. Sigh again... ... From: Daniel Yokomizo  Date: Dec 28, 2007 9:38 PM","rawEmail":"Return-Path: &lt;daniel.yokomizo@...&gt;\r\nX-Sender: daniel.yokomizo@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 38015 invoked from network); 29 Dec 2007 03:04:55 -0000\r\nX-Received: from unknown (66.218.67.97)\n  by m52.grp.scd.yahoo.com with QMQP; 29 Dec 2007 03:04:55 -0000\r\nX-Received: from unknown (HELO fg-out-1718.google.com) (72.14.220.155)\n  by mta18.grp.scd.yahoo.com with SMTP; 29 Dec 2007 03:04:54 -0000\r\nX-Received: by fg-out-1718.google.com with SMTP id 22so1772695fge.20\n        for &lt;rest-discuss@yahoogroups.com&gt;; Fri, 28 Dec 2007 19:04:53 -0800 (PST)\r\nX-Received: by 10.86.86.12 with SMTP id j12mr9569582fgb.68.1198897493729;\n        Fri, 28 Dec 2007 19:04:53 -0800 (PST)\r\nX-Received: by 10.86.89.19 with HTTP; Fri, 28 Dec 2007 19:04:53 -0800 (PST)\r\nMessage-ID: &lt;e5c6ecab0712281904v5aec4792nf8c8e8864118cc5c@...&gt;\r\nDate: Sat, 29 Dec 2007 03:04:53 +0000\r\nTo: rest-discuss@yahoogroups.com\r\nIn-Reply-To: &lt;e5c6ecab0712281338y79990bc9of6f51ecb72eda400@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 7bit\r\nContent-Disposition: inline\r\nReferences: &lt;e5c6ecab0712272320s3da54fp6f03a00303cb0c17@...&gt;\n\t &lt;20071228160847.GA15252@klangraum&gt;\n\t &lt;e5c6ecab0712280837x86463ccg92f7e192112c4156@...&gt;\n\t &lt;F35FE2E4-1C21-482C-A68A-1CC9FC5AAD74@...&gt;\n\t &lt;e5c6ecab0712281338y79990bc9of6f51ecb72eda400@...&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;\r\nSubject: Fwd: [rest-discuss] Re: Idempotency of PUT when using IF-MATCH\r\nX-Yahoo-Group-Post: member; u=302633978; y=Bam1GNMwQf5QS00Bo1LKMtOt3Z9uNxzuyMrXdppACy1qABgmM6lht2JY\r\nX-Yahoo-Profile: daniel_yokomiso\r\n\r\nForwarding to the list because I hit reply instead of reply all. Sigh again...\n\n\n---------- Forwarded message ----------\nFrom: Daniel Yokomizo &lt;daniel.yokomizo@...&gt;\nDate: Dec 28, 2007 9:38 PM\nSubject: Re: [rest-discuss] Re: Idempotency of PUT when using IF-MATCH\nTo: &quot;Roy T. Fielding&quot; &lt;fielding@...&gt;\n\n\nOn Dec 28, 2007 8:56 PM, Roy T. Fielding &lt;fielding@...&gt; wrote:\n&gt; On Dec 28, 2007, at 8:37 AM, Daniel Yokomizo wrote:\n&gt; &gt; On Dec 28, 2007 4:08 PM, Aristotle Pagaltzis &lt;pagaltzis@...&gt; wrote:\n&gt; &gt; &gt; * Daniel Yokomizo &lt;daniel.yokomizo@...&gt; [2007-12-28 14:30]:\n&gt; &gt; &gt; &gt; 1. Client A sents PUT ... (IF-MATCH: &quot;XXX&quot;) ... FOO ...\n&gt; &gt; &gt; &gt; 2. Server process the request and sends the new ETag: YYY\n&gt; &gt; &gt; &gt; 3. Client B sents PUT ... (IF-MATCH: &quot;YYY&quot;) ... BAR\n&gt; &gt; &gt; &gt; 4. Server process the request and sends the new ETag: ZZZ\n&gt; &gt; &gt; &gt; 5. Client A retries the first PUT (network problems, double\n&gt; &gt; submit, it\n&gt; &gt; &gt; &gt; doesn&#39;t matter) sends ETag: YYY\n&gt; &gt; &gt;\n&gt; &gt; &gt; I don&#39;t understand this sequence. You say the client sends ETag\n&gt; &gt; &gt; XXX in step #1, but when it retries the request in step #5, it\n&gt; &gt; &gt; sends ETag YYY. Did you make a typo somewhere or did you omit\n&gt; &gt; &gt; things from your timeline?\n&gt; &gt;\n&gt; &gt; Ops, it&#39;s a typo indeed. It should be ETag XXX. I hope this clears\n&gt; &gt; remaining confusion for everyone. It&#39;s supposed to be a simple retry\n&gt; &gt; of the first PUT, (e.g. client A\n&gt; &gt; never saw the response and want to ensure everything is fine). In the\n&gt; &gt; meantime Client B saw A&#39;s changes (because he has the unforgeable YYY\n&gt; &gt; ETag) and submits it&#39;s own changes.\n&gt; &gt;\n&gt;\n&gt; In that case, client A definitely wants to receive the 412, since\n&gt; otherwise it will never know about client B&#39;s changes.\n\nI see, but doesn&#39;t a 412 imply that the operation failed? The trick\npart is that client A don&#39;t know if request was processed (e.g.\nconnection issues) and as PUT is idempotent it automatically retries.\nIf it gets a 412 it will assume the request was never processed in the\nfirst place, when it was. The only way I see to let it know the\nrequest was processed is returning a 20X, but it won&#39;t be able to know\nthat B processed it later. We can return &quot;Cache-Control:\nmust-revalidate&quot; to indicate the content is stale.\n\nThis situation worries me because the server knows the request is a\nduplicate submission, it knows the initial submission worked and there\nare no correct usage that would issue this twice if it was not to for\nPUT&#39;s idempotency.\n\nRephrasing my original question, is it against the spec to return a\n20X (with &quot;Cache-Control: must-revalidate&quot; if other submissions\nalready happened), instead of 412? Is this usage of &quot;Vary: If-Match&quot;\nand If-Match unsound?\n\n&gt; A more interesting question is whether the spec over-constrains the\n&gt; case where a PUT is successful but tried again.  In other words, should\n&gt; the server be allowed to accept the PUT if the etag differs but the\n&gt; current state matches what is being PUT?  Subversion handles such\n&gt; cases nicely because it is common for two developers to patch the\n&gt; same bugs.  I think the &quot;MUST respond with 412&quot; is yet another case\n&gt; of a bogus requirement being added in 2616.\n&gt;\n&gt; Note: this is an HTTP spec issue, not a REST issue.\n&gt;\n&gt; ....Roy\n\nBest regards,\nDaniel Yokomizo.\n\n"}}