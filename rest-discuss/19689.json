{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":401876259,"authorName":"Will Hartung","from":"Will Hartung &lt;willh@...&gt;","profile":"gaminginparis","replyTo":"SENDER","senderId":"fUVF3TLdiOFud-scjLxEKqEc2ewh7GVpdn1yUlLurl3MY3F1HUUL-ZMgA3IbYKRUNK1ozW9DDcyERnSheVudzs-cXdtnU7YPxA","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [rest-discuss] RESTful Toggle","postDate":"1404937066","msgId":19689,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PENBQTJpRGlCYl9SRjlYWHFVeGNabWJIOUJ3bkxnbVZES2lIVWtVdE90aWdlaURqUUhMQUBtYWlsLmdtYWlsLmNvbT4=","inReplyToHeader":"PENBQWdWemRpeFZMTlpLMFg9a0g5WF9qODhzVzlpc3hKX3JnakQyaFB0TGdmT3lqYmpDQUBtYWlsLmdtYWlsLmNvbT4=","referencesHeader":"PENGRTFEQUM5LjM3NjQ4JVJvYmJ5LlNpbXBzb25AR0UuY29tPgk8Q0EreGhBUFdRNWlUSHZaLXlrQkRZR1RoUndOVFkwSlQ1RTJOOFdNaFhyWWl0eWZmc3NRQG1haWwuZ21haWwuY29tPgk8Q0ZFMkQ1MTUuMzc3MEYlUm9iYnkuU2ltcHNvbkBHRS5jb20+CTw1M0JENjI0Qy43MDQwMzA2QGJlcmtlbGV5LmVkdT4JPENGRTJEQUYwLjM3NzM1JVJvYmJ5LlNpbXBzb25AR0UuY29tPgk8NTNCRDZGNzUuODAzMDYwOEBiZXJrZWxleS5lZHU+CTxDQUEyaURpRERkZTNBWXMza1ZYUldLM0c4TVJjU1lTb1FNMEhmUitZenJ1TGZHak1iRlFAbWFpbC5nbWFpbC5jb20+CTxDQUFnVnpkalZLR1MrLVVxOEx1S0JWanNCNWtWRFVqRHR5Tnh2V2c3SFAzdzBGblloNlFAbWFpbC5nbWFpbC5jb20+CTxDQUhCVTZpdUNkZW1zZjUxUjY5bTIxK3NIWkVKRGN3X2RVQnB3SnAxK01lWi1yUmgyQ0FAbWFpbC5nbWFpbC5jb20+CTxDQUFnVnpkaXhWTE5aSzBYPWtIOVhfajg4c1c5aXN4Sl9yZ2pEMmhQdExnZk95amJqQ0FAbWFpbC5nbWFpbC5jb20+"},"prevInTopic":19687,"nextInTopic":19690,"prevInTime":19688,"nextInTime":19690,"topicId":19657,"numMessagesInTopic":36,"msgSnippet":"A conditional PUT is focusing on the mechanic, not the result. A PUT /light ON is idempotent. When it s done, the light is turned on, whether it was on or","rawEmail":"Return-Path: &lt;willh@...&gt;\r\nX-Sender: willh@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 63197 invoked by uid 102); 9 Jul 2014 20:17:46 -0000\r\nX-Received: from unknown (HELO mtaq6.grp.bf1.yahoo.com) (10.193.84.37)\n  by m12.grp.bf1.yahoo.com with SMTP; 9 Jul 2014 20:17:46 -0000\r\nX-Received: (qmail 12035 invoked from network); 9 Jul 2014 20:17:46 -0000\r\nX-Received: from unknown (HELO mail-wi0-f174.google.com) (209.85.212.174)\n  by mtaq6.grp.bf1.yahoo.com with SMTP; 9 Jul 2014 20:17:46 -0000\r\nX-Received: by mail-wi0-f174.google.com with SMTP id d1so1128836wiv.13\n        for &lt;rest-discuss@yahoogroups.com&gt;; Wed, 09 Jul 2014 13:17:46 -0700 (PDT)\r\nX-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\n        d=1e100.net; s=20130820;\n        h=x-gm-message-state:mime-version:in-reply-to:references:date\n         :message-id:subject:from:to:cc:content-type;\n        bh=HNU5etHVUzbZXv+pgjoG6cgNPcDpqH88fcwSzGxogmM=;\n        b=AbpHsc4tOPvxcWSg3z/ifC74GVlnuyNTQOt3uOKsBR/cKqdobLHKQY21FTiFD6AimD\n         wwjpb61to0wwuzv3os6Wnh26uMMsq42EFQs/PMvg9EdP3fKJUgtf/YWpVqj49QBYV51h\n         i/+WTXbPnDl7XPf83eqaZBGAHuWeiCL4vMgi09tbLjRWVFmybbotV/z75fGotTXq/2WO\n         tz51CPQNCxQR4HEksOGJBp1npu3BMxN/YS+U+ngbuFEt2j5ZiR3U9ExJxmL7ZKg4i0tP\n         w3E/+JPRvMO+/qsK2zActyOUd6ihQoNOHVEDULXDXszHSsfQN4PO1y868qt13JUrX+L5\n         f8jQ==\r\nX-Gm-Message-State: ALoCoQktFBkCnZaXr8daaXezcm7QaOn2NKKdFKDUkq+VTWOlQkPDJj4GmQHmlli7ukSR4avS6tF41J0ygo/2KuFonwbNIDQ0d8UmxRrfqOpLgbGafoD1a2s=\r\nMIME-Version: 1.0\r\nX-Received: by 10.194.63.196 with SMTP id i4mr51469847wjs.50.1404937066356;\n Wed, 09 Jul 2014 13:17:46 -0700 (PDT)\r\nX-Received: by 10.194.237.3 with HTTP; Wed, 9 Jul 2014 13:17:46 -0700 (PDT)\r\nIn-Reply-To: &lt;CAAgVzdixVLNZK0X=kH9X_j88sW9isxJ_rgjD2hPtLgfOyjbjCA@...&gt;\r\nReferences: &lt;CFE1DAC9.37648%Robby.Simpson@...&gt;\n\t&lt;CA+xhAPWQ5iTHvZ-ykBDYGThRwNTY0JT5E2N8WMhXrYityffssQ@...&gt;\n\t&lt;CFE2D515.3770F%Robby.Simpson@...&gt;\n\t&lt;53BD624C.7040306@...&gt;\n\t&lt;CFE2DAF0.37735%Robby.Simpson@...&gt;\n\t&lt;53BD6F75.8030608@...&gt;\n\t&lt;CAA2iDiDDde3AYs3kVXRWK3G8MRcSYSoQM0HfR+YzruLfGjMbFQ@...&gt;\n\t&lt;CAAgVzdjVKGS+-Uq8LuKBVjsB5kVDUjDtyNxvWg7HP3w0FnYh6Q@...&gt;\n\t&lt;CAHBU6iuCdemsf51R69m21+sHZEJDcw_dUBpwJp1+MeZ-rRh2CA@...&gt;\n\t&lt;CAAgVzdixVLNZK0X=kH9X_j88sW9isxJ_rgjD2hPtLgfOyjbjCA@...&gt;\r\nDate: Wed, 9 Jul 2014 13:17:46 -0700\r\nMessage-ID: &lt;CAA2iDiBb_RF9XXqUxcZmbH9BwnLgmVDKiHUkUtOtigeiDjQHLA@...&gt;\r\nTo: Dong Liu &lt;edongliu@...&gt;\r\nCc: Tim Bray &lt;tbray@...&gt;, Rest List &lt;rest-discuss@yahoogroups.com&gt;\r\nContent-Type: multipart/alternative; boundary=047d7b86dd00c5eb7d04fdc86697\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nSubject: Re: [rest-discuss] RESTful Toggle\r\nX-Yahoo-Group-Post: member; u=401876259; y=iUsSEjrZxEkzmfkyXVvncJ0qfvsMt-xM2fr-SYWH-jJguMRKmUZZ5Q\r\nX-Yahoo-Profile: gaminginparis\r\nFrom: Will Hartung &lt;willh@...&gt;\r\n\r\n\r\n--047d7b86dd00c5eb7d04fdc86697\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nA conditional PUT is focusing on the mechanic, not the result.\n\nA PUT /ligh=\r\nt &quot;ON&quot; is idempotent. When it&#39;s done, the light is turned on,\nwhether it wa=\r\ns on or not.\n\nFrom a user perspective, they want the light &quot;ON&quot;, how that i=\r\ns achieved\nthey simply don&#39;t care about.\n\nThe conditional PUT is &quot;toggle th=\r\ne switch unless it&#39;s already toggled&quot;,\nwhich is pretty silly. It&#39;s silly be=\r\ncause that level of coordination simply\nshould not be exposed. It&#39;s also si=\r\nlly because it can be simply emulated by\nfetching the state and PUTing to t=\r\nhe the Other State (or an other state).\n\nThere are certainly scenarios for =\r\noptimistic locking, I just don&#39;t really\nthink this is one of them.\n\nAs far =\r\nas the latency issue, again, you&#39;re talking about primitives. If you\nneed t=\r\no control a bank of lights, create a representation at the\nappropriate gran=\r\nularity. Something like, I dunno, &quot;room&quot;. PUT\n/lights/room/living ON.\n\nIn t=\r\nhe end, the system should control the light directly, and should have\nacces=\r\ns to the state of the lights. The &quot;switches&quot; (whether on the wall or\nan iPh=\r\none) should be inputs to the system, which then interprets those\ninputs and=\r\n reacts with lights turning on and off. The switch does not turn\nthe light =\r\non, it asks the system to turn the light on, and the system will\ndo so if i=\r\nt deems it appropriate based on its internal rules.\n\nRegards,\n\nWill Hartung=\r\n\n(willh@...)\n\n\nOn Wed, Jul 9, 2014 at 12:29 PM, Dong Liu &lt;edongli=\r\nu@...&gt; wrote:\n\n&gt; Right, a conditional PUT does not match an N-way swi=\r\ntch well. To me, it is\n&gt; even better than the real N-way switch because it =\r\nreflects the true will of\n&gt; a user and avoids confusion (somehow magic) whe=\r\nn his kids are pushing the\n&gt; other switches for the same light.\n&gt;\n&gt;\n&gt;\n&gt; On =\r\nWed, Jul 9, 2014 at 3:16 PM, Tim Bray &lt;tbray@...&gt; wrote:\n&gt;\n&gt;&gt; Ho=\r\nw is that idempotent?  You absolutely can=E2=80=99t use PUT unless it=E2=80=\r\n=99s\n&gt;&gt; idempotent.\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; On Wed, Jul 9, 2014 at 12:09 PM, Dong Liu e=\r\ndongliu@...\n&gt;&gt; [rest-discuss] &lt;rest-discuss-noreply@yahoogroups.com&gt; =\r\nwrote:\n&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; For a three-way or N-way switch, I prefer a condition=\r\nal PUT to a POST.\n&gt;&gt;&gt;\n&gt;&gt;&gt; Cheers,\n&gt;&gt;&gt;\n&gt;&gt;&gt; Dong\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; On Wed, Jul 9, 2=\r\n014 at 2:45 PM, Will Hartung willh@...\n&gt;&gt;&gt; [rest-discuss] &lt;rest-d=\r\niscuss-noreply@yahoogroups.com&gt; wrote:\n&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; From home automat=\r\nion point of view, I can only think of one use case\n&gt;&gt;&gt;&gt; where &quot;toggle&quot; act=\r\nually has any validity, and that would be in the &quot;3 way\n&gt;&gt;&gt;&gt; switch&quot; scenar=\r\nio.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; A 3 way switch is exemplified by walking up to a dark hallway=\r\n, turning\n&gt;&gt;&gt;&gt; the light on with a nearby swtich, walking to the end, and t=\r\nhen turning the\n&gt;&gt;&gt;&gt; light off with a switch at the other end.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Th=\r\nis use case is a true &quot;toggle&quot;, since the &quot;state&quot; is the actual light\n&gt;&gt;&gt;&gt; =\r\n(on or off), and the switch itself does not represent that state (unlike a\n=\r\n&gt;&gt;&gt;&gt; normal, single switch). The switches can be &quot;up&quot; or &quot;down&quot; unrelated t=\r\no the\n&gt;&gt;&gt;&gt; light being &quot;on&quot; or &quot;off&quot;.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Given that, again from a ho=\r\nme automation point of view, I can&#39;t really\n&gt;&gt;&gt;&gt; ever see &quot;toggle&quot; as a via=\r\nble action. Maybe it&#39;s a primitive. But, in the\n&gt;&gt;&gt;&gt; end, when you walk in =\r\nto that dark hallway, what you want is the light to\n&gt;&gt;&gt;&gt; go on, the mechani=\r\ncs of the switches are secondary.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; I just mention this because at =\r\na high level, &quot;toggle&quot; doesn&#39;t make much\n&gt;&gt;&gt;&gt; sense to me. The automation f=\r\nolks may well need it as a primitive to\n&gt;&gt;&gt;&gt; control a switch. But at the &quot;=\r\napplication&quot; level, it doesn&#39;t make much\n&gt;&gt;&gt;&gt; sense. At an application leve=\r\nl, you either want the &quot;Light&quot; ON or OFF.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; So, with that considera=\r\ntion, a simple POST will do the trick.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; I don&#39;t think there&#39;s any =\r\n&quot;race condition&quot;, because &quot;toggle&quot; is not a\n&gt;&gt;&gt;&gt; state, it&#39;s an action. If =\r\nyou care about the state, then set the state you\n&gt;&gt;&gt;&gt; want. You should hide=\r\n the &quot;toggle&quot;, and enforce the state behind the scenes\n&gt;&gt;&gt;&gt; (where you can =\r\nmanage race conditions on the server). Let the server decide\n&gt;&gt;&gt;&gt; that when=\r\n you change the state to ON, it can determine, internally, if the\n&gt;&gt;&gt;&gt; devi=\r\nce is OFF and then send a TOGGLE command to make it ON. If it&#39;s already\n&gt;&gt;&gt;=\r\n&gt; ON, then nothing happens.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; But a &quot;toggle&quot; POST is just that, a s=\r\nimple command.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Regards,\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Will Hartung\n&gt;&gt;&gt;&gt; (willh@mirthc=\r\norp.com)\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; On Wed, Jul 9, 2014 at 9:36 AM, Erik Wild=\r\ne dret@...\n&gt;&gt;&gt;&gt; [rest-discuss] &lt;rest-discuss-noreply@yahoogroups.c=\r\nom&gt; wrote:\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; hello robby.\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; On 2014-07-09, 1=\r\n7:47 , &#39;Simpson, Robby (GE Energy Management)&#39;\n&gt;&gt;&gt;&gt;&gt; robby.simpson@... [=\r\nrest-discuss] wrote:\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; it sounds like the scenario we were talking a=\r\nbout, that all you\n&gt;&gt;&gt;&gt;&gt; want is\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; to tell the resource to &quot;reverse =\r\nits state&quot;. in this case, i&#39;d POST\n&gt;&gt;&gt;&gt;&gt; a\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; body that represents th=\r\nis request, in whatever serialization you\n&gt;&gt;&gt;&gt;&gt; happen\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; to prefer. =\r\nthe resource toggles. everybody&#39;s happy.\n&gt;&gt;&gt;&gt;&gt; &gt; OK. Still seems like a bit=\r\n of a departure from typical RESTful\n&gt;&gt;&gt;&gt;&gt; interfaces\n&gt;&gt;&gt;&gt;&gt; &gt; I&#39;ve seen and=\r\n has the potential to be a catch-all tunnel for\n&gt;&gt;&gt;&gt;&gt; RPC-style\n&gt;&gt;&gt;&gt;&gt; &gt; req=\r\nuests.\n&gt;&gt;&gt;&gt;&gt; &gt; E.g.:\n&gt;&gt;&gt;&gt;&gt; &gt; /command, where one could POST all sorts of co=\r\nmmands like &quot;toggle.&quot;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; the problem is not that POST can mean any=\r\nthing (it can), but people\n&gt;&gt;&gt;&gt;&gt; POSTing things to a &quot;do stuff&quot; resource, w=\r\nhich then isn&#39;t\n&gt;&gt;&gt;&gt;&gt; resource-oriented anymore. your RPC sensor shouldn&#39;t =\r\ngo off because of\n&gt;&gt;&gt;&gt;&gt; people POSTing things to resources (that&#39;s fine), b=\r\nut because of\n&gt;&gt;&gt;&gt;&gt; people\n&gt;&gt;&gt;&gt;&gt; POSTing things to something other than res=\r\nources (the &quot;API end point&quot;,\n&gt;&gt;&gt;&gt;&gt; for example).\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; but i=\r\n am confused because you wrote earlier that you were concerned\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; abo=\r\nut race conditions. which seems to imply that instead of just\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; togg=\r\nling, you&#39;re also assuming that you&#39;re &quot;toggling *from* some\n&gt;&gt;&gt;&gt;&gt; state&quot;.\n=\r\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; but that wouldn&#39;t be the &quot;blind toggle&quot; we discussed. could you\n&gt;&gt;=\r\n&gt;&gt;&gt; clarify\n&gt;&gt;&gt;&gt;&gt; &gt;&gt; a bit how exactly the operation that you&#39;re trying to =\r\ndesign is\n&gt;&gt;&gt;&gt;&gt; defined?\n&gt;&gt;&gt;&gt;&gt; &gt; Apologies, a blind toggle is what is desir=\r\ned. As it currently works,\n&gt;&gt;&gt;&gt;&gt; in\n&gt;&gt;&gt;&gt;&gt; &gt; the current binary protocol, a =\r\nbutton press on a toggle switch simply\n&gt;&gt;&gt;&gt;&gt; &gt; sends a &quot;toggle&quot; command.\n&gt;&gt;=\r\n&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; then how would a race condition enter the picture? just because o=\r\nf the\n&gt;&gt;&gt;&gt;&gt; timestamp when you last observed the resource&#39;s state? or somet=\r\nhing\n&gt;&gt;&gt;&gt;&gt; else? to me, toggling always is kind of a game: if somebody togg=\r\nled\n&gt;&gt;&gt;&gt;&gt; ahead of you, you&#39;ll do something other than you wanted to, but t=\r\nhat&#39;s\n&gt;&gt;&gt;&gt;&gt; how it is and you&#39;ll have to deal with it after toggling and fi=\r\nnding\n&gt;&gt;&gt;&gt;&gt; out\n&gt;&gt;&gt;&gt;&gt; that you switched the damn thing back on again...\n&gt;&gt;&gt;=\r\n&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; cheers,\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; dret.\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; --\n&gt;&gt;&gt;&gt;&gt; erik wilde | =\r\nmailto:dret@... - tel:+1-510-2061079 |\n&gt;&gt;&gt;&gt;&gt; | UC Berkeley - Schoo=\r\nl of Information (ISchool) |\n&gt;&gt;&gt;&gt;&gt; | http://dret.net/netdret http://twitter=\r\n.com/dret |\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; CONFIDENTIALITY NOTICE: The information c=\r\nontained in this electronic\n&gt;&gt;&gt;&gt; transmission may be confidential. If you a=\r\nre not an intended recipient, be\n&gt;&gt;&gt;&gt; aware that any disclosure, copying, d=\r\nistribution or use of the information\n&gt;&gt;&gt;&gt; contained in this transmission i=\r\ns prohibited and may be unlawful. If you\n&gt;&gt;&gt;&gt; have received this transmissi=\r\non in error, please notify us by email reply\n&gt;&gt;&gt;&gt; and then erase it from yo=\r\nur computer system.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; \n&gt;&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; --\n&gt;&gt; - Tim Bray=\r\n (If you=E2=80=99d like to send me a private message, see\n&gt;&gt; https://keybas=\r\ne.io/timbray)\n&gt;&gt;\n&gt;\n&gt;\n\n-- \nCONFIDENTIALITY NOTICE: The information contained=\r\n in this electronic \ntransmission may be confidential. If you are not an in=\r\ntended recipient, be \naware that any disclosure, copying, distribution or u=\r\nse of the information \ncontained in this transmission is prohibited and may=\r\n be unlawful. If you \nhave received this transmission in error, please noti=\r\nfy us by email reply \nand then erase it from your computer system.\n\r\n--047d7b86dd00c5eb7d04fdc86697\r\nContent-Type: text/html; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n&lt;div dir=3D&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;A conditional PUT is focusin=\r\ng on the mechanic, not the result.&lt;br&gt;&lt;br&gt;&lt;/div&gt;A PUT /light &quot;ON&quot;=\r\n is idempotent. When it&#39;s done, the light is turned on, whether it was =\r\non or not.&lt;br&gt;\n&lt;br&gt;&lt;/div&gt;From a user perspective, they want the light &quot=\r\n;ON&quot;, how that is achieved they simply don&#39;t care about.&lt;br&gt;&lt;br&gt;Th=\r\ne conditional PUT is &quot;toggle the switch unless it&#39;s already toggle=\r\nd&quot;, which is pretty silly. It&#39;s silly because that level of coordi=\r\nnation simply should not be exposed. It&#39;s also silly because it can be =\r\nsimply emulated by fetching the state and PUTing to the the Other State (or=\r\n an other state).&lt;br&gt;\n&lt;br&gt;&lt;/div&gt;There are certainly scenarios for optimisti=\r\nc locking, I just don&#39;t really think this is one of them.&lt;br&gt;&lt;br&gt;As far=\r\n as the latency issue, again, you&#39;re talking about primitives. If you n=\r\need to control a bank of lights, create a representation at the appropriate=\r\n granularity. Something like, I dunno, &quot;room&quot;. PUT /lights/room/l=\r\niving ON.&lt;br&gt;\n&lt;br&gt;&lt;/div&gt;In the end, the system should control the light dir=\r\nectly, and should have access to the state of the lights. The &quot;switche=\r\ns&quot; (whether on the wall or an iPhone) should be inputs to the system, =\r\nwhich then interprets those inputs and reacts with lights turning on and of=\r\nf. The switch does not turn the light on, it asks the system to turn the li=\r\nght on, and the system will do so if it deems it appropriate based on its i=\r\nnternal rules.&lt;br&gt;\n&lt;br&gt;&lt;/div&gt;Regards,&lt;br&gt;&lt;br&gt;Will Hartung&lt;br&gt;&lt;/div&gt;(&lt;a href=\r\n=3D&quot;mailto:willh@...&quot;&gt;willh@...&lt;/a&gt;)&lt;br&gt;&lt;/div&gt;&lt;div clas=\r\ns=3D&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div class=3D&quot;gmail_quote&quot;&gt;On Wed, Jul 9, 2014 at=\r\n 12:29 PM, Dong Liu &lt;span dir=3D&quot;ltr&quot;&gt;&lt;&lt;a href=3D&quot;mailto:edongliu@gmail.=\r\ncom&quot; target=3D&quot;_blank&quot;&gt;edongliu@...&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;\n&lt;blockq=\r\nuote class=3D&quot;gmail_quote&quot; style=3D&quot;margin:0 0 0 .8ex;border-left:1px #ccc =\r\nsolid;padding-left:1ex&quot;&gt;&lt;div dir=3D&quot;ltr&quot;&gt;Right, a conditional PUT does not =\r\nmatch an N-way switch well. To me, it is even better than the real N-way sw=\r\nitch because it reflects the true will of a user and avoids confusion (some=\r\nhow magic) when his kids are pushing the other switches for the same light.=\r\n =C2=A0&lt;div&gt;\n&lt;div class=3D&quot;h5&quot;&gt;&lt;br&gt;\n&lt;div class=3D&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div=\r\n class=3D&quot;gmail_quote&quot;&gt;On Wed, Jul 9, 2014 at 3:16 PM, Tim Bray &lt;span dir=\r\n=3D&quot;ltr&quot;&gt;&lt;&lt;a href=3D&quot;mailto:tbray@...&quot; target=3D&quot;_blank&quot;&gt;tbra=\r\ny@...&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote class=3D&quot;gmail_quote&quot;=\r\n style=3D&quot;margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex&quot;&gt;\n\n=\r\n&lt;div dir=3D&quot;ltr&quot;&gt;&lt;div style=3D&quot;font-size:small&quot;&gt;How is that idempotent? =C2=\r\n=A0You absolutely can=E2=80=99t use PUT unless it=E2=80=99s idempotent.&lt;/di=\r\nv&gt;&lt;div style=3D&quot;font-size:small&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=3D&quot;gmail_extra&quot;=\r\n&gt;\n\n&lt;br&gt;&lt;br&gt;&lt;div class=3D&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;On Wed, Jul 9, 2014 at 12:0=\r\n9 PM, Dong Liu &lt;a href=3D&quot;mailto:edongliu@...&quot; target=3D&quot;_blank&quot;&gt;edon=\r\ngliu@...&lt;/a&gt; [rest-discuss] &lt;span dir=3D&quot;ltr&quot;&gt;&lt;&lt;a href=3D&quot;mailto:r=\r\nest-discuss-noreply@yahoogroups.com&quot; target=3D&quot;_blank&quot;&gt;rest-discuss-noreply=\r\n@yahoogroups.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;\n\n\n\n&lt;/div&gt;&lt;/div&gt;&lt;blockquote class=\r\n=3D&quot;gmail_quote&quot; style=3D&quot;margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=\r\ning-left:1ex&quot;&gt;\n\n\n\n\n\n\n        \n\n\n\n\n&lt;div&gt;&lt;div&gt;&lt;div&gt;\n\n\n\n\n\n&lt;br&gt;&lt;br&gt;\n\n\n\n\n&lt;div di=\r\nr=3D&quot;ltr&quot;&gt;For a three-way or N-way switch, I prefer a conditional PUT to a =\r\nPOST.=C2=A0&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Dong&lt;/div&gt;&lt;=\r\n/div&gt;&lt;div class=3D&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div class=3D&quot;gmail_quote&quot;&gt;On Wed, =\r\nJul 9, 2014 at 2:45 PM, Will Hartung &lt;a href=3D&quot;mailto:willh@...&quot;=\r\n target=3D&quot;_blank&quot;&gt;willh@...&lt;/a&gt; [rest-discuss] &lt;span dir=3D&quot;ltr&quot;=\r\n&gt;&lt;&lt;a href=3D&quot;mailto:rest-discuss-noreply@yahoogroups.com&quot; target=3D&quot;_bla=\r\nnk&quot;&gt;rest-discuss-noreply@yahoogroups.com&lt;/a&gt;&gt;&lt;/span&gt; wrote:&lt;br&gt;\n\n\n\n\n&lt;blo=\r\nckquote class=3D&quot;gmail_quote&quot; style=3D&quot;margin:0 0 0 .8ex;border-left:1px #c=\r\ncc solid;padding-left:1ex&quot;&gt;\n\n\n&lt;u&gt;&lt;/u&gt;\n\n\n\n\n\n\n\n\n\n \n&lt;div style=3D&quot;background-c=\r\nolor:#fff&quot;&gt;\n&lt;span&gt;=C2=A0&lt;/span&gt;\n\n\n&lt;div&gt;\n  &lt;div&gt;\n\n\n    &lt;div&gt;\n      \n      \n =\r\n     &lt;p&gt;&lt;/p&gt;&lt;div dir=3D&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;From home a=\r\nutomation point of view, I can only think of one use case where &quot;toggl=\r\ne&quot; actually has any validity, and that would be in the &quot;3 way swi=\r\ntch&quot; scenario.&lt;br&gt;\n\n\n\n\n\n&lt;br&gt;&lt;/div&gt;\nA 3 way switch is exemplified by wa=\r\nlking up to a dark hallway, turning the light on with a nearby swtich, walk=\r\ning to the end, and then turning the light off with a switch at the other e=\r\nnd.&lt;br&gt;&lt;br&gt;&lt;/div&gt;This use case is a true &quot;toggle&quot;, since the &quo=\r\nt;state&quot; is the actual light (on or off), and the switch itself does n=\r\not represent that state (unlike a normal, single switch). The switches can =\r\nbe &quot;up&quot; or &quot;down&quot; unrelated to the light being &quot;on=\r\n&quot; or &quot;off&quot;.&lt;br&gt;\n\n\n\n\n\n\n&lt;br&gt;&lt;/div&gt;Given that, again from a hom=\r\ne automation point of view, I can&#39;t really ever see &quot;toggle&quot; =\r\nas a viable action. Maybe it&#39;s a primitive. But, in the end, when you w=\r\nalk in to that dark hallway, what you want is the light to go on, the mecha=\r\nnics of the switches are secondary.&lt;br&gt;\n\n\n\n\n\n\n&lt;br&gt;&lt;/div&gt;I just mention this=\r\n because at a high level, &quot;toggle&quot; doesn&#39;t make much sense to=\r\n me. The automation folks may well need it as a primitive to control a swit=\r\nch. But at the &quot;application&quot; level, it doesn&#39;t make much sens=\r\ne. At an application level, you either want the &quot;Light&quot; ON or OFF=\r\n.&lt;br&gt;\n\n\n\n\n\n&lt;br&gt;&lt;/div&gt;So, with that consideration, a simple POST will do the=\r\n trick.&lt;br&gt;&lt;br&gt;&lt;/div&gt;I don&#39;t think there&#39;s any &quot;race condition=\r\n&quot;, because &quot;toggle&quot; is not a state, it&#39;s an action. If y=\r\nou care about the state, then set the state you want. You should hide the &=\r\nquot;toggle&quot;, and enforce the state behind the scenes (where you can m=\r\nanage race conditions on the server). Let the server decide that when you c=\r\nhange the state to ON, it can determine, internally, if the device is OFF a=\r\nnd then send a TOGGLE command to make it ON. If it&#39;s already ON, then n=\r\nothing happens.&lt;br&gt;\n\n\n\n\n\n&lt;br&gt;&lt;/div&gt;But a &quot;toggle&quot; POST is just th=\r\nat, a simple command.&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Regards,&lt;br&gt;&lt;br&gt;=\r\nWill Hartung&lt;br&gt;(&lt;a href=3D&quot;mailto:willh@...&quot; target=3D&quot;_blank&quot;&gt;w=\r\nillh@...&lt;/a&gt;)&lt;br&gt;\n\n\n\n\n&lt;/div&gt;&lt;div&gt;&lt;br&gt;\n&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;=\r\n&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div class=3D&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;=\r\n&lt;div class=3D&quot;gmail_quote&quot;&gt;On Wed, Jul 9, 2014 at 9:36 AM, Erik Wilde &lt;a hr=\r\nef=3D&quot;mailto:dret@...&quot; target=3D&quot;_blank&quot;&gt;dret@...&lt;/a&gt; [re=\r\nst-discuss] &lt;span dir=3D&quot;ltr&quot;&gt;&lt;&lt;a href=3D&quot;mailto:rest-discuss-noreply@ya=\r\nhoogroups.com&quot; target=3D&quot;_blank&quot;&gt;rest-discuss-noreply@yahoogroups.com&lt;/a&gt;&g=\r\nt;&lt;/span&gt; wrote:&lt;br&gt;\n\n\n\n\n\n&lt;blockquote class=3D&quot;gmail_quote&quot; style=3D&quot;border=\r\n-left:1px #ccc solid&quot;&gt;\n\n\n&lt;u&gt;&lt;/u&gt;\n\n\n\n\n\n\n\n\n\n \n&lt;div style=3D&quot;background-color:=\r\n#fff&quot;&gt;\n&lt;span&gt;=C2=A0&lt;/span&gt;\n\n\n&lt;div&gt;\n  &lt;div&gt;\n\n\n    &lt;div&gt;\n      \n      \n      =\r\n&lt;p&gt;hello robby.&lt;br&gt;\n&lt;br&gt;\nOn 2014-07-09, 17:47 , &#39;Simpson, Robby (GE Ene=\r\nrgy Management)&#39; &lt;br&gt;&lt;/p&gt;&lt;div&gt;\n&lt;a href=3D&quot;mailto:robby.simpson@...&quot; =\r\ntarget=3D&quot;_blank&quot;&gt;robby.simpson@...&lt;/a&gt; [rest-discuss] wrote:&lt;br&gt;\n&gt;&g=\r\nt; it sounds like the scenario we were talking about, that all you want is&lt;=\r\nbr&gt;\n&gt;&gt; to tell the resource to &quot;reverse its state&quot;. in this=\r\n case, i&#39;d POST a&lt;br&gt;\n&gt;&gt; body that represents this request, in wh=\r\natever serialization you happen&lt;br&gt;\n&gt;&gt; to prefer. the resource toggle=\r\ns. everybody&#39;s happy.&lt;br&gt;\n&gt; OK.  Still seems like a bit of a departu=\r\nre from typical RESTful interfaces&lt;br&gt;\n&gt; I&#39;ve seen and has the poten=\r\ntial to be a catch-all tunnel for RPC-style&lt;br&gt;\n&gt; requests.&lt;br&gt;\n&gt; E.g=\r\n.:&lt;br&gt;\n&gt; /command, where one could POST all sorts of commands like &quot=\r\n;toggle.&quot;&lt;br&gt;\n&lt;br&gt;&lt;/div&gt;\nthe problem is not that POST can mean anythin=\r\ng (it can), but people &lt;br&gt;\nPOSTing things to a &quot;do stuff&quot; resour=\r\nce, which then isn&#39;t &lt;br&gt;\nresource-oriented anymore. your RPC sensor sh=\r\nouldn&#39;t go off because of &lt;br&gt;\npeople POSTing things to resources (that=\r\n&#39;s fine), but because of people &lt;br&gt;\nPOSTing things to something other =\r\nthan resources (the &quot;API end point&quot;, &lt;br&gt;\nfor example).&lt;div&gt;&lt;br&gt;\n=\r\n&lt;br&gt;\n&gt;&gt; but i am confused because you wrote earlier that you were con=\r\ncerned&lt;br&gt;\n&gt;&gt; about race conditions. which seems to imply that instea=\r\nd of just&lt;br&gt;\n&gt;&gt; toggling, you&#39;re also assuming that you&#39;re &=\r\nquot;toggling *from* some state&quot;.&lt;br&gt;\n&gt;&gt; but that wouldn&#39;t b=\r\ne the &quot;blind toggle&quot; we discussed. could you clarify&lt;br&gt;\n&gt;&gt;=\r\n a bit how exactly the operation that you&#39;re trying to design is define=\r\nd?&lt;br&gt;\n&gt; Apologies, a blind toggle is what is desired.  As it currently =\r\nworks, in&lt;br&gt;\n&gt; the current binary protocol, a button press on a toggle =\r\nswitch simply&lt;br&gt;\n&gt; sends a &quot;toggle&quot; command.&lt;br&gt;\n&lt;br&gt;&lt;/div&gt;\nt=\r\nhen how would a race condition enter the picture? just because of the &lt;br&gt;\n=\r\ntimestamp when you last observed the resource&#39;s state? or something &lt;br=\r\n&gt;\nelse? to me, toggling always is kind of a game: if somebody toggled &lt;br&gt;\n=\r\nahead of you, you&#39;ll do something other than you wanted to, but that&#3=\r\n9;s &lt;br&gt;\nhow it is and you&#39;ll have to deal with it after toggling and f=\r\ninding out &lt;br&gt;\nthat you switched the damn thing back on again...&lt;div&gt;&lt;br&gt;\n=\r\n&lt;br&gt;\ncheers,&lt;br&gt;\n&lt;br&gt;\ndret.&lt;br&gt;\n&lt;br&gt;\n-- &lt;br&gt;\nerik wilde | mailto:&lt;a href=3D=\r\n&quot;mailto:dret@...&quot; target=3D&quot;_blank&quot;&gt;dret@...&lt;/a&gt;  -  tel:=\r\n&lt;a href=3D&quot;tel:%2B1-510-2061079&quot; value=3D&quot;+15102061079&quot; target=3D&quot;_blank&quot;&gt;+=\r\n1-510-2061079&lt;/a&gt; |&lt;br&gt;\n            | UC Berkeley  -  School of Information=\r\n (ISchool) |&lt;br&gt;\n            | &lt;a href=3D&quot;http://dret.net/netdret&quot; target=\r\n=3D&quot;_blank&quot;&gt;http://dret.net/netdret&lt;/a&gt; &lt;a href=3D&quot;http://twitter.com/dret&quot;=\r\n target=3D&quot;_blank&quot;&gt;http://twitter.com/dret&lt;/a&gt; |&lt;br&gt;\n&lt;/div&gt;&lt;p&gt;&lt;/p&gt;\n\n    &lt;/d=\r\niv&gt;\n     \n\n    \n    &lt;div style=3D&quot;color:#fff;min-height:0&quot;&gt;&lt;/div&gt;\n\n\n&lt;/div&gt;\n=\r\n\n\n\n  \n\n\n\n\n\n\n&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;\n\n&lt;br&gt;\n&lt;/div&gt;&lt;/div&gt;&lt;sp=\r\nan&gt;&lt;font face=3D&quot;Arial&quot; size=3D&quot;1&quot;&gt;CONFIDENTIALITY NOTICE: The information =\r\ncontained in this electronic transmission may be confidential. If you are n=\r\not an intended recipient, be aware that any disclosure, copying, distributi=\r\non or use of the information contained in this transmission is prohibited a=\r\nnd may be unlawful. If you have received this transmission in error, please=\r\n notify us by email reply and then erase it from your computer system.&lt;/fon=\r\nt&gt;&lt;/span&gt;&lt;p&gt;\n\n\n\n\n&lt;/p&gt;\n\n    &lt;/div&gt;\n     \n\n    \n    &lt;div style=3D&quot;color:#fff;=\r\nmin-height:0&quot;&gt;&lt;/div&gt;\n\n\n&lt;/div&gt;\n\n\n\n  \n\n\n\n\n\n\n&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;b=\r\nr&gt;&lt;/div&gt;\n\n\n\n\n\n\n&lt;br&gt;\n\n\n&lt;br&gt;\n\n\n\n\n&lt;div width=3D&quot;1&quot; style=3D&quot;color:white;clear:=\r\nboth&quot;&gt;&lt;/div&gt;\n\n\n\n&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br clear=3D&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/di=\r\nv&gt;-- &lt;br&gt;&lt;div dir=3D&quot;ltr&quot;&gt;&lt;div&gt;- Tim Bray (If you=E2=80=99d like to send me=\r\n a private message, see &lt;a href=3D&quot;https://keybase.io/timbray&quot; target=3D&quot;_b=\r\nlank&quot;&gt;https://keybase.io/timbray&lt;/a&gt;)&lt;/div&gt;\n\n\n\n&lt;/div&gt;\n&lt;/div&gt;&lt;/div&gt;\n&lt;/blockq=\r\nuote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;\n\n&lt;br&gt;=\r\n\n&lt;span&gt;&lt;font face=3D&quot;Arial&quot; size=3D&quot;1&quot;&gt;CONFIDENTIALITY NOTICE: The informat=\r\nion contained in this electronic transmission may be confidential. If you a=\r\nre not an intended recipient, be aware that any disclosure, copying, distri=\r\nbution or use of the information contained in this transmission is prohibit=\r\ned and may be unlawful. If you have received this transmission in error, pl=\r\nease notify us by email reply and then erase it from your computer system.&lt;=\r\n/font&gt;&lt;/span&gt;\r\n--047d7b86dd00c5eb7d04fdc86697--\r\n\n"}}