{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":5701961,"authorName":"Berend de Boer","from":"Berend de Boer &lt;berend@...&gt;","profile":"berenddeboer","replyTo":"SENDER","senderId":"qbTvOEADPDaSvQr1PPz8gguT4s8PEi8aW3AZbKVcbqHw27S4Voka3J4lAS7XWBviB3N7hPfmphscPmZKVk04_ag5zvxMzy9S","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [rest-discuss] CSRF attacks in RESTful authenticated web applications","postDate":"1211850436","msgId":10828,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDg3bGsxdzV6Y3IuZnNmQGR1bGxpby5uZWRlcndhcmUubmw+","inReplyToHeader":"PGU1YzZlY2FiMDgwNTI2MTYzMG00NDY3ZDBqMTg2ZWIyZmJmMGRiOTAxMkBtYWlsLmdtYWlsLmNvbT4JKERhbmllbCBZb2tvbWl6bydzIG1lc3NhZ2Ugb2YgIk1vbiwgMjYgTWF5IDIwMDggMjA6MzA6MDUgLTAzMDAiKQ==","referencesHeader":"PDQ4M0IxRUJGLjMwMzA5MDNAa29lbG4uZGU+IDw4N2Z4czQ5MnRpLmZzZkBkdWxsaW8ubmVkZXJ3YXJlLm5sPgk8NDgzQjMyMzYuODA1MDcwMEBrb2Vsbi5kZT4gPDg3emxxYzdrcnYuZnNmQGR1bGxpby5uZWRlcndhcmUubmw+CTxDNDdFRTUyRi1BRjI1LTQ1OUYtQUJFMi1FMDE3QTM3ODdEQkFAc3ViYnUub3JnPgk8ODdwcnI4N2o3OC5mc2ZAZHVsbGlvLm5lZGVyd2FyZS5ubD4JPGU1YzZlY2FiMDgwNTI2MTYzMG00NDY3ZDBqMTg2ZWIyZmJmMGRiOTAxMkBtYWlsLmdtYWlsLmNvbT4="},"prevInTopic":10827,"nextInTopic":10829,"prevInTime":10827,"nextInTime":10829,"topicId":10818,"numMessagesInTopic":21,"msgSnippet":"... Daniel Even if GET is safe, if the URL can be guessed and you use Daniel an exploitable authority, CSRF can leak confidential Daniel information. If my","rawEmail":"Return-Path: &lt;berend@...&gt;\r\nX-Sender: berend@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 67961 invoked from network); 27 May 2008 01:07:19 -0000\r\nX-Received: from unknown (66.218.67.95)\n  by m54.grp.scd.yahoo.com with QMQP; 27 May 2008 01:07:19 -0000\r\nX-Received: from unknown (HELO ironport-smtp02.maxnet.net.nz) (123.100.71.102)\n  by mta16.grp.scd.yahoo.com with SMTP; 27 May 2008 01:07:18 -0000\r\nX-IronPort-Anti-Spam-Filtered: true\r\nX-IronPort-Anti-Spam-Result: ApoEAFb7Okh7ZEdv/2dsb2JhbACsTw\r\nX-Received: from smtp02.maxnet.net.nz ([123.100.71.111])\n  by ironport-smtp02.maxnet.net.nz with ESMTP; 27 May 2008 13:07:18 +1200\r\nX-Received: from bmach.nederware.nl (unknown [123.100.112.87])\n\tby smtp02.maxnet.net.nz (Postfix) with ESMTP id 1F78C6BD94;\n\tTue, 27 May 2008 13:07:18 +1200 (NZST)\r\nX-Received: from dullio.nederware.nl (dullio.nederware.nl [192.168.33.7])\n\t(using TLSv1 with cipher EDH-RSA-DES-CBC3-SHA (168/168 bits))\n\t(No client certificate requested)\n\tby bmach.nederware.nl (Postfix) with ESMTPSA id 8C82A17011;\n\tTue, 27 May 2008 13:07:17 +1200 (NZST)\r\nX-Received: from dullio.nederware.nl (localhost [127.0.0.1])\n\tby dullio.nederware.nl (Postfix) with ESMTP id 656418A835;\n\tTue, 27 May 2008 13:07:16 +1200 (NZST)\r\nTo: &quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;\r\nCc: &quot;Subbu Allamaraju&quot; &lt;subbu@...&gt;,\n\t&quot;Simon Reinhardt&quot; &lt;simon.reinhardt@...&gt;,\n\trest-discuss@yahoogroups.com\r\nReferences: &lt;483B1EBF.3030903@...&gt; &lt;87fxs492ti.fsf@...&gt;\n\t&lt;483B3236.8050700@...&gt; &lt;87zlqc7krv.fsf@...&gt;\n\t&lt;C47EE52F-AF25-459F-ABE2-E017A3787DBA@...&gt;\n\t&lt;87prr87j78.fsf@...&gt;\n\t&lt;e5c6ecab0805261630m4467d0j186eb2fbf0db9012@...&gt;\r\nFace: iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAP1BMVEUJEgAlGhQgHCI8KB1W\n PS9fPCMzQ3JuPypXSllCVIeIVD55XU9NZKNYZpaoWkiaYUFkcZmiaFG7d1yzfGDIjG/bCLklAAAA\n AXRSTlMAQObYZgAAAAlwSFlzAAALiQAAC4kBN8nLrQAAAhpJREFUSMeVlY2SgyAMhFVAIIqI+P7P\n ehuitdc5Uy/Tae3MfuSPWbvur5issYhp6p7FZPq+N4ahZwjrJcyDNNMlP5HHemMEeVaO4S7kSyPs\n m9p5bySmr/MxzjlPRA7HqymsqD3EOW8le4SzGiB6VrfICCJltIe+Vlbvu0CF7ieLDNZRhn6Hfj8R\n ZxXAUdnq/goGigbYD4CJSjqw/Q/wpbaG30rSAGuplPIc6KwrEvUiar2d6kLeQ4w74fmh7hV/PJU7\n YFmWQpIADCqrWxFWAVB/LTTZqVXFW+aulluAGoAMtbF5KXairAG0HWuo27JtSAm81uW2JuIUxzVa\n ODAjfG6ntPgGyEUVgDMqAJ1AS7B9A3gR55pF276/AVUW3OoRTLMlXw79xv14BpQEL4BvRDMA5/MX\n wBGAKnIG4CBZB1xF8HJb4CrhWbVWg81mrkP2wEajACk4dgGIKt/sUpoxdRoA73PoAFZGHh23HwWI\n McCHLawVhGfHRN/K+yFFEPJOcNTCO8VYWX4SvWnuDf2t16c4jnFGxHE4CJRzb/U4fhzn+SQGeU1o\n epwvGQQx0klYb+QQXSkYCRMvOcR1/XOY8Tg4XkSCb4SYxrR+MiufLe3+ImKwY0RrINL6oT8HNL8V\n Na94o+L8MaUEbv09/BN4I1I2QwhpTS3iqxlZ1ou4igq57+0woB4kkMregYs4gDgYk10/hLWpE9pJ\n CfofzVo1VdGgppkAAAAASUVORK5CYII=\r\nX-Home-Page: http://www.pobox.com/~berend/\r\nDate: Tue, 27 May 2008 13:07:16 +1200\r\nIn-Reply-To: &lt;e5c6ecab0805261630m4467d0j186eb2fbf0db9012@...&gt;\n\t(Daniel Yokomizo&#39;s message of &quot;Mon, 26 May 2008 20:30:05 -0300&quot;)\r\nMessage-ID: &lt;87lk1w5zcr.fsf@...&gt;\r\nUser-Agent: Gnus/5.110007 (No Gnus v0.7) Emacs/22.1 (gnu/linux)\r\nMIME-Version: 1.0\r\nContent-Type: multipart/signed; protocol=&quot;application/x-pkcs7-signature&quot;; micalg=sha1; boundary=&quot;----EA6F497DB2B72EE702BE8B15D2F087A4&quot;\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Berend de Boer &lt;berend@...&gt;\r\nSubject: Re: [rest-discuss] CSRF attacks in RESTful authenticated web applications\r\nX-Yahoo-Group-Post: member; u=5701961; y=tLm_ovhwVVHvqF9YtIbRlojsDr3YcLSYZyaLAJVUaeu_tTi6PM4Y\r\nX-Yahoo-Profile: berenddeboer\r\n\r\n\r\n------EA6F497DB2B72EE702BE8B15D2F087A4\r\nContent-Type: text/plain; charset=iso-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n&gt;&gt;&gt;&gt;&gt; &quot;Daniel&quot; =3D=3D Daniel Yokomizo &lt;daniel.yokomizo@...&gt; writes:\n\n=\r\n    Daniel&gt; Even if GET is safe, if the URL can be guessed and you use\n    =\r\nDaniel&gt; an exploitable authority, CSRF can leak confidential\n    Daniel&gt; in=\r\nformation. If my bank has a CSRF vulnerable account\n    Daniel&gt; statement f=\r\nunctionality any attacker can exploit the bug and\n    Daniel&gt; trick my brow=\r\nser into leaking my information.\n\nHow? In your example:\n\n\n    Daniel&gt; The G=\r\nMAIL CSRF bug could even be exploited this way (it was\n    Daniel&gt; actually=\r\n exploited by creation of filters) Alice request for\n    Daniel&gt; a new pass=\r\nword for Bob in site X, also Alice knows (or\n    Daniel&gt; guesses) that Bob =\r\nuses webmail from X, which is vulnerable\n    Daniel&gt; to GET /mailbox/bob/ne=\r\nw-messages, Alice tricks Bob into\n    Daniel&gt; accessing a page that exploit=\r\ns the bug and sends the result\n    Daniel&gt; of GET /mailbox/bob/new-messages=\r\n to Alice&#39;s own mailbox and\n    Daniel&gt; voil=E1, Alice now can go to site X=\r\n, access with the new\n    Daniel&gt; password and do whatever she wants with B=\r\nob stuff (in site\n    Daniel&gt; X). Confidentiality matters too.\n\nI don&#39;t rea=\r\nlly see how this can happen. I&#39;m probably not the greatest\nlight in this gr=\r\noup :-)\n\nWhen I tried to reason how that could happen, I came up with this.=\r\n \n\nBob visits malicious.com and malicious.com has an iframe that goes to\nba=\r\nnk/my/balance.\n\nSo far I see the big picture. But how can get Alice send th=\r\nat data to\nher? If she can write JavaScript that accesses that data in the =\r\niframe,\nit&#39;s a browser bug, because you can&#39;t do that. She can&#39;t use XHR to=\r\n\nretrieve that data, that&#39;s also forbidden.\n\nSo how, given we have a site a=\r\nt REST, can Alice get Bob&#39;s data assuming\nBob will visit any page Alice wil=\r\nl send him?\n\n-- \nCheers,\n\nBerend de Boer\n\r\n------EA6F497DB2B72EE702BE8B15D2F087A4\r\nContent-Type: application/x-pkcs7-signature; name=&quot;smime.p7s&quot;\r\nContent-Disposition: attachment; filename=&quot;smime.p7s&quot;\r\n\r\n[ Attachment content not displayed ]\r\n------EA6F497DB2B72EE702BE8B15D2F087A4--\r\n\n"}}