{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":302633978,"authorName":"Daniel Yokomizo","from":"&quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;","profile":"daniel_yokomiso","replyTo":"SENDER","senderId":"e1ohKqYpOANNGgNJzFsJh7qY3yuN-xWgokep8nEkBSva9zNk2-ZnX9_-AEckf2mXG6ErOC-N2_l9a6OBqbR3c6v82SL3YoCp_J4hD4QzQOZ_IyeZ","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [rest-discuss] Re: Idempotency of PUT when using IF-MATCH","postDate":"1198859860","msgId":10098,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGU1YzZlY2FiMDcxMjI4MDgzN3g4NjQ2M2NjZzkyZjdlMTkyMTEyYzQxNTZAbWFpbC5nbWFpbC5jb20+","inReplyToHeader":"PDIwMDcxMjI4MTYwODQ3LkdBMTUyNTJAa2xhbmdyYXVtPg==","referencesHeader":"PGU1YzZlY2FiMDcxMjI3MjMyMHMzZGE1NGZwNmYwM2EwMDMwM2NiMGMxN0BtYWlsLmdtYWlsLmNvbT4JIDwyMDA3MTIyODE2MDg0Ny5HQTE1MjUyQGtsYW5ncmF1bT4="},"prevInTopic":10096,"nextInTopic":10099,"prevInTime":10097,"nextInTime":10099,"topicId":10088,"numMessagesInTopic":12,"msgSnippet":"... Ops, it s a typo indeed. It should be ETag XXX. I hope this clears remaining confusion for everyone. It s supposed to be a simple retry of the first PUT,","rawEmail":"Return-Path: &lt;daniel.yokomizo@...&gt;\r\nX-Sender: daniel.yokomizo@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 94166 invoked from network); 28 Dec 2007 16:37:41 -0000\r\nX-Received: from unknown (66.218.67.97)\n  by m47.grp.scd.yahoo.com with QMQP; 28 Dec 2007 16:37:41 -0000\r\nX-Received: from unknown (HELO mu-out-0910.google.com) (209.85.134.184)\n  by mta18.grp.scd.yahoo.com with SMTP; 28 Dec 2007 16:37:41 -0000\r\nX-Received: by mu-out-0910.google.com with SMTP id i10so2822392mue.5\n        for &lt;rest-discuss@yahoogroups.com&gt;; Fri, 28 Dec 2007 08:37:40 -0800 (PST)\r\nX-Received: by 10.86.51.2 with SMTP id y2mr9078992fgy.56.1198859860346;\n        Fri, 28 Dec 2007 08:37:40 -0800 (PST)\r\nX-Received: by 10.86.89.19 with HTTP; Fri, 28 Dec 2007 08:37:40 -0800 (PST)\r\nMessage-ID: &lt;e5c6ecab0712280837x86463ccg92f7e192112c4156@...&gt;\r\nDate: Fri, 28 Dec 2007 16:37:40 +0000\r\nTo: rest-discuss@yahoogroups.com\r\nIn-Reply-To: &lt;20071228160847.GA15252@klangraum&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 7bit\r\nContent-Disposition: inline\r\nReferences: &lt;e5c6ecab0712272320s3da54fp6f03a00303cb0c17@...&gt;\n\t &lt;20071228160847.GA15252@klangraum&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;\r\nSubject: Re: [rest-discuss] Re: Idempotency of PUT when using IF-MATCH\r\nX-Yahoo-Group-Post: member; u=302633978; y=KkWLUhfeH-Q7lhiXgAPGtT7ntpTGc4DkdAUBRq58zcN87Scc0HFxhcEa\r\nX-Yahoo-Profile: daniel_yokomiso\r\n\r\nOn Dec 28, 2007 4:08 PM, Aristotle Pagaltzis &lt;pagaltzis@...&gt; wrote:\n&gt; * Daniel Yokomizo &lt;daniel.yokomizo@...&gt; [2007-12-28 14:30]:\n&gt; &gt; 1. Client A sents PUT ... (IF-MATCH: &quot;XXX&quot;) ... FOO ...\n&gt; &gt; 2. Server process the request and sends the new ETag: YYY\n&gt; &gt; 3. Client B sents PUT ... (IF-MATCH: &quot;YYY&quot;) ... BAR\n&gt; &gt; 4. Server process the request and sends the new ETag: ZZZ\n&gt; &gt; 5. Client A retries the first PUT (network problems, double submit, it\n&gt; &gt; doesn&#39;t matter) sends ETag: YYY\n&gt;\n&gt; I don&#39;t understand this sequence. You say the client sends ETag\n&gt; XXX in step #1, but when it retries the request in step #5, it\n&gt; sends ETag YYY. Did you make a typo somewhere or did you omit\n&gt; things from your timeline?\n\nOps, it&#39;s a typo indeed. It should be ETag XXX. I hope this clears\nremaining confusion for everyone. It&#39;s supposed to be a simple retry\nof the first PUT, (e.g. client A\nnever saw the response and want to ensure everything is fine). In the\nmeantime Client B saw A&#39;s changes (because he has the unforgeable YYY\nETag) and submits it&#39;s own changes.\n\n&gt; &gt; My application can compute the new version identifier for FOO and\n&gt; &gt; it will always be YYY, so doing a quick check it finds this version\n&gt; &gt; already persisted and it can safely assume that it&#39;s a duplicate\n&gt; &gt; submission. My question is: can it return a 200 to this duplicate\n&gt; &gt; request or it must return a 412, as per section 14.24? AFAICT\n&gt; &gt; returning 200 should be OK, but I don&#39;t want to take chances of going\n&gt; &gt; against the Internet ;) or messing with some subtle implicit rule\n&gt; &gt; about caching (e.g. some intermediate cache between both client A and\n&gt; &gt; client B overwrite B&#39;s update and become inconsistent).\n&gt;\n&gt; A resource cannot have multiple equally valid ETags at the same\n&gt; time if intermediaries are supposed to understand its current\n&gt; state. It can have several variants, each of which may have their\n&gt; own ETag, but then you need to include a Vary response header to\n&gt; let intermediaries know how what to look at in client requests in\n&gt; order to find out which variant is being requested.\n\nYes, I&#39;m assuming Vary for the current URI and no Vary for the\nspecific revisions. The URLs are:\n\n/&lt;resources&gt;/&lt;id&gt;   (with Vary)\n/&lt;resources&gt;/&lt;id&gt;/&lt;version&gt; (without Vary)\n/&lt;resources&gt;/&lt;id&gt;/current (without Vary and using appropriate Cache\ndirectives to avoid caching)\n\nPUT is allowed only on the main URL (it could be allowed on the\ncurrent too, but it isn&#39;t) because we can&#39;t put in a specific version:\nit&#39;s supposed to be immutable.\n\n&gt; Regards,\n&gt; --\n&gt; Aristotle Pagaltzis // &lt;http://plasmasturm.org/&gt;\n\nBest regards,\nDaniel Yokomizo.\n\n"}}