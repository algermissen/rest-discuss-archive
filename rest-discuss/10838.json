{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":302633978,"authorName":"Daniel Yokomizo","from":"&quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;","profile":"daniel_yokomiso","replyTo":"SENDER","senderId":"rqmEFAKDAW0qA0-15HdxtmgNM3F2PfsjOPs8BX9sePHvtUteTniO3jszssvnAJLaUJba-7yLj-XYPeaSdJ0V63uCQ07rwDBWsYVjiG0ux2KYo_eF","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [rest-discuss] CSRF attacks in RESTful authenticated web applications","postDate":"1211924573","msgId":10838,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGU1YzZlY2FiMDgwNTI3MTQ0MmwxMTViOTcxNW4yNWVlYTE5MTFiMWM2YmE4QG1haWwuZ21haWwuY29tPg==","inReplyToHeader":"PDQ4M0M3Q0M3LjMwMDA1QGtvZWxuLmRlPg==","referencesHeader":"PDQ4M0IxRUJGLjMwMzA5MDNAa29lbG4uZGU+CSA8ZTVjNmVjYWIwODA1MjYxNTE1aDgwMzhkYTNnZDI0N2NkODllYzcxZDgyMUBtYWlsLmdtYWlsLmNvbT4JIDw0ODNDNTRFRS4yMDkwMDA3QGtvZWxuLmRlPgkgPGU1YzZlY2FiMDgwNTI3MTI0NGo0ZjM1YjJiYmdlNmJhMTc5ZjAyZDk3MGYwQG1haWwuZ21haWwuY29tPgkgPDQ4M0M3Q0M3LjMwMDA1QGtvZWxuLmRlPg=="},"prevInTopic":10837,"nextInTopic":10839,"prevInTime":10837,"nextInTime":10839,"topicId":10818,"numMessagesInTopic":21,"msgSnippet":"On Tue, May 27, 2008 at 6:27 PM, Simon Reinhardt ... You can use a database, as long as the resource is identified by the URI nothing is wrong with that. ... ","rawEmail":"Return-Path: &lt;daniel.yokomizo@...&gt;\r\nX-Sender: daniel.yokomizo@...\r\nX-Apparently-To: rest-discuss@yahoogroups.com\r\nX-Received: (qmail 10696 invoked from network); 27 May 2008 21:42:54 -0000\r\nX-Received: from unknown (66.218.67.95)\n  by m55.grp.scd.yahoo.com with QMQP; 27 May 2008 21:42:54 -0000\r\nX-Received: from unknown (HELO fg-out-1718.google.com) (72.14.220.154)\n  by mta16.grp.scd.yahoo.com with SMTP; 27 May 2008 21:42:54 -0000\r\nX-Received: by fg-out-1718.google.com with SMTP id d23so1673990fga.39\n        for &lt;rest-discuss@yahoogroups.com&gt;; Tue, 27 May 2008 14:42:53 -0700 (PDT)\r\nX-Received: by 10.86.98.10 with SMTP id v10mr7617457fgb.46.1211924573156;\n        Tue, 27 May 2008 14:42:53 -0700 (PDT)\r\nX-Received: by 10.86.9.6 with HTTP; Tue, 27 May 2008 14:42:53 -0700 (PDT)\r\nMessage-ID: &lt;e5c6ecab0805271442l115b9715n25eea1911b1c6ba8@...&gt;\r\nDate: Tue, 27 May 2008 18:42:53 -0300\r\nTo: &quot;Simon Reinhardt&quot; &lt;simon.reinhardt@...&gt;\r\nCc: rest-discuss@yahoogroups.com\r\nIn-Reply-To: &lt;483C7CC7.30005@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 7bit\r\nContent-Disposition: inline\r\nReferences: &lt;483B1EBF.3030903@...&gt;\n\t &lt;e5c6ecab0805261515h8038da3gd247cd89ec71d821@...&gt;\n\t &lt;483C54EE.2090007@...&gt;\n\t &lt;e5c6ecab0805271244j4f35b2bbge6ba179f02d970f0@...&gt;\n\t &lt;483C7CC7.30005@...&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;Daniel Yokomizo&quot; &lt;daniel.yokomizo@...&gt;\r\nSubject: Re: [rest-discuss] CSRF attacks in RESTful authenticated web applications\r\nX-Yahoo-Group-Post: member; u=302633978; y=bJeJb4wQRDXLtWxQyANwD3Wv19Fw4JKs3aBnDxLHyy3nsQP9CHc1aNoP\r\nX-Yahoo-Profile: daniel_yokomiso\r\n\r\nOn Tue, May 27, 2008 at 6:27 PM, Simon Reinhardt\n&lt;simon.reinhardt@...&gt; wrote:\n&gt; Daniel Yokomizo wrote:\n&gt;&gt; On Tue, May 27, 2008 at 3:37 PM, Simon Reinhardt\n&gt;&gt; &lt;simon.reinhardt@...&gt; wrote:\n&gt;&gt;&gt; Daniel Yokomizo wrote:\n&gt;&gt;&gt;&gt; Using HATEOAS you can avoid the first issue: the\n&gt;&gt;&gt;&gt; client of the app must use the links in the response to navigate to\n&gt;&gt;&gt;&gt; the next states, so the server can generate URIs that are unguessable\n&gt;&gt;&gt;&gt; (e.g. GUIDs, cryptography) and the attacker is unable to name a\n&gt;&gt;&gt;&gt; resource used in the session.\n&gt;&gt;&gt;\n&gt;&gt;&gt; How exactly would that work? If the URIs are unguessable then they have to be unrelated to anything the client knows, i.e. they contain random tokens. But the server would have to remember those tokens and relate them to the user (which is really just sessions with a session ID in a request parameter) and then you have server state. How is that still RESTful?\n&gt;&gt;\n&gt;&gt; REST don&#39;t prohibit state, as long as you can name it. The URI /foo/1\n&gt;&gt; denotes a resource that can be retrieved from database, to make it\n&gt;&gt; unguessable you can use a GUID (e.g /{GUID}/foo/1 or /foo/{GUID} or\n&gt;&gt; /{GUID})\n&gt;\n&gt; But the server still needs to relate the GUID to something? Otherwise any GUID would work and then it&#39;s &quot;guessable&quot; again.\n\nYou can use a database, as long as the resource is identified by the\nURI nothing is wrong with that.\n\n&gt;&gt; cryptography (e.g. /{encrypted URI} so the server decrypts\n&gt;&gt; the URI before using it), etc..\n&gt;\n&gt; Ah, makes sense.\n&gt;\n&gt;&gt; Also REST don&#39;t favor (or prohibit)\n&gt;&gt; pretty or hackable URIs (it&#39;s a design decision) and it don&#39;t\n&gt;&gt; guarantee that some URI will exist later (as it can always return 404,\n&gt;&gt; 410, etc.) so you can enforce the rule that the client (a human or an\n&gt;&gt; app) must GET the entry point and navigate using links to the\n&gt;&gt; interesting states (i.e. other URIs), generating the URIs to be useful\n&gt;&gt; only for some predefined period or whatever\n&gt;\n&gt; I pretty much prefer pretty and hackable URIs. And I also think that cool URIs shouldn&#39;t change. ;-)\n&gt;\n&gt;&gt; (I don&#39;t like this\n&gt;&gt; approach, but it&#39;s important to understand that it isn&#39;t RESTful).\n&gt;\n&gt; Did you mean &quot;is&quot; here?\n\nYup, &quot;it is RESTful&quot;.\n\n&gt;&gt;&gt; - sending them to friends leads to problems\n&gt;&gt;\n&gt;&gt; Which kind of problems?\n&gt;\n&gt; Well, there&#39;s always the argument that they could hijack your session but of course you would check the IP address of the requester. :-) (Would *that* be RESTful?)\n&gt; So what would the friend see? A 401? a 403? A redirect to the login form? Of course if they login from there they could get redirected back to the resource, just with their session parameter appended to the URI instead of mine. But why create a new session for them if they are already logged in with another session? Ok, this is the trade-off between security and convenience you talk about below.\n\nIf you send your friend an URI pointing to you bank statement and the\nbank app don&#39;t use cookies or authentication headers then he should\nsee everything you see. You can protect it both with authentication\nheaders and using an unguessable URI. I like to see unguessable URIs\nas capabilities, so you should be able to share then (at your\ndiscretion).\n\n&gt;&gt;&gt; - you have several URIs for one and the same resource\n&gt;&gt;\n&gt;&gt; Why would it be a problem?\n&gt;\n&gt; It makes referring to resources ambiguous, especially on the Semantic Web.\n\nWhile a canonical, unambiguous, URI for each URI is a good thing to\nhave, it usually isn&#39;t a problem to have more than one URI to a single\nresource. Also you can always use redirect to enforce a canonical URI\nor even ensure that no two different GUIDs point to the same resource.\n\n&gt;&gt;&gt; - you just need to have one URI which doesn&#39;t contain the session ID (maybe a link to a wiki related to your application which is coded as a separate application but integrated into the same framing template with menus and stuff) and you are &quot;logged out&quot;; clicking on links in the menu will not lead you back into the application in an authenticated state.\n&gt;&gt;\n&gt;&gt; You can send an unguessable entry point URI using an out of band\n&gt;&gt; channel (e.g. email). Or you can use a guessable entry point and use\n&gt;&gt; some form of login to redirect to the unguessable world.\n&gt;\n&gt; So you said, but if your website contains both public pages which should be viewable without logging in and protected pages, then every pointer from a protected page to a public page can either include the session identifier (but a related wiki might use its own session system?) or not include it, meaning that the user can&#39;t go from the public page back into the protected section without logging in with a new session or using the back-button.\n\nDepending on how you add the unguessable part to the URI you can hack\nyour way: you could use the form /{unguessable}/{whatever} to denote a\nprivate resource and /{whatever} to denote a public resource and use a\nrelative path in the public parts.\n\n&gt;&gt; It&#39;s important to understand that most of the time there&#39;s a trade-off\n&gt;&gt; between security and convenience. You need to define your security\n&gt;&gt; policy, for example if your app don&#39;t do external transactions (i.e.\n&gt;&gt; credit-card payments, send e-mails, update other apps) you don&#39;t need\n&gt;&gt; much security beyond being able to undo changes in your own data, so a\n&gt;&gt; revision aware storage system and a simple simple authentication\n&gt;&gt; process could solve most of your problems. Banking apps, the checkout\n&gt;&gt; of e-commerce apps, etc., have different security needs. You could use\n&gt;&gt; guessable URIs in some parts of your app and unguessable in other\n&gt;&gt; parts, using some stronger form of authentication to separate them. It\n&gt;&gt; all depends on your needs, there&#39;s no one-size fits all solution.\n&gt;\n&gt; Right, this makes sense. It helps me figuring out how to secure my next web application. :-)\n&gt; I think I have a much better picture of authentication possibilities now, thanks!\n&gt;\n&gt; Simon\n\n\nBest regards,\nDaniel Yokomizo\n\n"}}